<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Circuit Builder - STEM Learn Odisha</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: #f0f7ff; color:#1e293b; line-height:1.6; overflow-x:hidden; }
        .container { width:100%; max-width:1400px; margin:0 auto; padding:0 20px; }

        /* Language Switcher */
        .language-switcher { position:absolute; top:20px; right:20px; background: rgba(255,255,255,0.15); border-radius:25px; padding:8px; backdrop-filter: blur(6px); z-index:1000; display:flex; gap:6px; }
        .lang-btn { padding:8px 12px; border:none; background:transparent; border-radius:16px; cursor:pointer; font-size:0.9rem; font-weight:600; color:white; }
        .lang-btn.active { background: rgba(255,255,255,0.25); color:white; }
        
        /* header */
        header { background: linear-gradient(135deg,#0e2a47 0%,#1a365d 100%); color:white; padding:15px 0; position:sticky; top:0; z-index:100; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
        .header-content { display:flex; justify-content:space-between; align-items:center; position:relative; }
        .logo { display:flex; gap:12px; align-items:center; }
        .logo-icon { font-size:2.2rem; background:white; color:#2a69ac; width:55px; height:55px; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
        .logo-text { font-size:1.6rem; font-weight:700; }
        .logo-text span { color:#38b2ac; font-weight:800; }
        nav ul { display:flex; gap:18px; list-style:none; }
        nav a { color:white; text-decoration:none; font-weight:500; padding:8px 12px; border-radius:8px; }
        
        /* Instructions Modal */
        .instructions-modal { 
            display: flex; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0, 0, 0, 0.85); 
            z-index: 2000; 
            align-items: center; 
            justify-content: center; 
        }
        .instructions-content { 
            background: white; 
            border-radius: 20px; 
            width: 90%; 
            max-width: 700px; 
            padding: 30px; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); 
            position: relative; 
            text-align: center; 
        }
        .instructions-title { font-size: 2rem; margin-bottom: 20px; color: #1a365d; font-weight: 700; }
        .instructions-text { color: #64748b; margin-bottom: 25px; line-height: 1.6; text-align: left; font-size: 1.1rem; }
        .instructions-list { margin-left: 20px; margin-bottom: 25px; }
        .instructions-list li { margin-bottom: 10px; }
        .start-game-btn { 
            padding: 15px 40px; 
            background: linear-gradient(135deg, #38b2ac 0%, #2c9a94 100%); 
            color: white; 
            border: none; 
            border-radius: 10px; 
            font-size: 1.2rem; 
            font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            margin-top: 20px; 
        }
        .start-game-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(56, 178, 172, 0.3); }

        /* Demo Overlay */
        .demo-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 3000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .demo-step {
            background: white;
            color: #1a365d;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
        }

        .demo-step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .demo-step h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #2a69ac;
        }

        .demo-step p {
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: #4a5568;
        }

        .demo-step-image {
            width: 100%;
            height: 200px;
            background: #f7fafc;
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            border: 2px dashed #4299e1;
        }

        .demo-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .demo-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .demo-next {
            background: linear-gradient(45deg, #38b2ac, #2c9a94);
            color: white;
        }

        .demo-next:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(56, 178, 172, 0.4);
        }

        .demo-skip {
            background: transparent;
            color: #718096;
            border: 2px solid #718096;
        }

        .demo-skip:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .demo-start-game {
            background: linear-gradient(45deg, #d69e2e, #b7791f);
            color: white;
            min-width: 180px;
        }

        .demo-start-game:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(214, 158, 46, 0.4);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Post-Demo Message */
        .post-demo-message {
            display: none;
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 50px auto;
            animation: fadeIn 0.5s ease;
        }

        .post-demo-message.active {
            display: block;
        }

        .post-demo-icon {
            font-size: 5rem;
            color: #38b2ac;
            margin-bottom: 20px;
        }

        .post-demo-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        /* game header */
        .game-header { 
            background: linear-gradient(135deg, #0e2a47 0%, #1a365d 100%); 
            color:white; 
            padding:40px 0; 
            text-align:center; 
        }
        .game-header h1 { font-size:2.5rem; margin-bottom:12px; font-weight:700; text-shadow:0 2px 4px rgba(0,0,0,0.2); }
        .game-header p { font-size:1.1rem; max-width:800px; margin:0 auto; font-weight:300; opacity:0.95; }

        /* game stats (second UI) */
        .game-stats { display:flex; justify-content:space-between; align-items:center; background:white; padding:15px 25px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin:20px auto; max-width:1200px; gap:12px; flex-wrap:wrap; }
        .timer, .score, .hints { display:flex; align-items:center; gap:10px; font-size:1.1rem; font-weight:600; color:#1a365d; }
        .timer i { color:#e53e3e; }
        .score i { color:#38a169; }
        .hints i { color:#d69e2e; }
        .progress-container { flex:1; max-width:300px; height:12px; background:#e2e8f0; border-radius:10px; overflow:hidden; }
        .progress-bar { height:100%; background:#3182ce; border-radius:10px; transition: width 0.5s ease; }

        /* game area */
        .game-area { 
            padding:30px 0 50px; 
            background-color: #f0f7ff;
        }
        .game-container { display:grid; grid-template-columns:300px 1fr; gap:30px; max-width:1200px; margin:0 auto 40px auto; height:600px; }
        
        /* Components Library */
        .components-zone { 
            background: rgba(255,255,255,0.95); 
            border-radius:25px; 
            padding:25px; 
            box-shadow:0 10px 30px rgba(0,0,0,0.08); 
            display:flex; 
            flex-direction:column; 
            border:3px solid #cbd5e0; 
            overflow-y: auto;
        }
        
        .zone-header { 
            display:flex; 
            align-items:center; 
            gap:15px; 
            margin-bottom:20px; 
        }
        
        .zone-icon { 
            width:50px; 
            height:50px; 
            border-radius:50%; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            font-size:1.4rem; 
        }
        
        .components-icon { 
            background: linear-gradient(45deg,#48bb78,#38a169); 
            color:white; 
        }
        
        .zone-title { 
            font-size:1.3rem; 
            font-weight:700; 
            color:#1a365d; 
        }

        /* Circuit Board Zone */
        .circuit-zone { 
            background: rgba(255,255,255,0.95); 
            border-radius:25px; 
            padding:25px; 
            box-shadow:0 10px 30px rgba(0,0,0,0.08); 
            display:flex; 
            flex-direction:column; 
            border:3px solid #cbd5e0;
            overflow: hidden;
        }

        .circuit-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .circuit-icon { 
            background: linear-gradient(45deg,#4facfe,#00f2fe); 
            color:white; 
        }

        /* Circuit Board - Large with grid */
        .circuit-board {
            width: 100%;
            height: 400px;
            background: 
                repeating-linear-gradient(0deg, rgba(66, 153, 225, 0.05) 0px, rgba(66, 153, 225, 0.05) 1px, transparent 1px, transparent 40px),
                repeating-linear-gradient(90deg, rgba(66, 153, 225, 0.05) 0px, rgba(66, 153, 225, 0.05) 1px, transparent 1px, transparent 40px);
            border-radius: 15px;
            position: relative;
            overflow: auto;
            border: 2px solid #cbd5e0;
            flex: 1;
            min-height: 400px;
        }

        /* Circuit Component */
        .circuit-component {
            position: absolute;
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: move;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 10;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            user-select: none;
        }

        .circuit-component:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: #4299e1;
            z-index: 100;
        }

        .circuit-component.dragging {
            opacity: 0.7;
            transform: scale(1.05) rotate(5deg);
            z-index: 1000;
        }

        .circuit-component.powered {
            animation: pulseGlow 2s infinite;
            border-color: #38a169;
        }

        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 15px rgba(56, 161, 105, 0.5); }
            50% { box-shadow: 0 0 25px rgba(56, 161, 105, 0.8); }
        }

        .circuit-component.placed {
            animation: placeComponent 0.5s ease;
        }

        @keyframes placeComponent {
            0% { transform: scale(0) rotate(180deg); opacity: 0; }
            70% { transform: scale(1.1) rotate(-10deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .component-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        .component-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #1a365d;
            text-align: center;
            padding: 0 5px;
        }

        /* Component Terminals */
        .terminal {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #718096;
            border: 3px solid white;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }

        .terminal:hover {
            transform: scale(1.5);
            box-shadow: 0 0 15px currentColor;
        }

        .terminal.positive {
            background: #e53e3e;
        }

        .terminal.negative {
            background: #4299e1;
        }

        .terminal.neutral {
            background: #718096;
        }

        .terminal.selected {
            background: #38a169;
            animation: terminalPulse 1s infinite;
            box-shadow: 0 0 0 5px rgba(56, 161, 105, 0.3);
        }

        .terminal.connected {
            background: #38a169;
            box-shadow: 0 0 10px #38a169;
        }

        /* Wires - Visible connections */
        .wire {
            position: absolute;
            background: #a0aec0;
            height: 6px;
            border-radius: 3px;
            transform-origin: 0 0;
            z-index: 5;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .wire.connected {
            background: #718096;
        }

        .wire.powered {
            background: linear-gradient(90deg, #e53e3e, #ed8936, #38a169);
            background-size: 200% 100%;
            animation: currentFlow 1s linear infinite;
            box-shadow: 0 0 15px rgba(56, 161, 105, 0.7);
            height: 8px;
        }

        /* Wire Creation Helper */
        .wire-helper {
            position: absolute;
            background: #d69e2e;
            height: 6px;
            border-radius: 3px;
            transform-origin: 0 0;
            z-index: 15;
            pointer-events: none;
            display: none;
        }

        .wire-helper.visible {
            display: block;
        }

        @keyframes currentFlow {
            0% { background-position: 0% 0%; }
            100% { background-position: 200% 0%; }
        }

        /* Current Flow Particles */
        .current-particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #38a169 40%, transparent 70%);
            border-radius: 50%;
            box-shadow: 0 0 10px #38a169;
            z-index: 6;
            pointer-events: none;
            opacity: 0;
        }

        /* Components Library */
        .components-library {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        .library-item {
            width: 100%;
            height: 100px;
            background: linear-gradient(145deg,#ffffff,#f0f4f8);
            border-radius:16px;
            display:flex;
            flex-direction:column;
            align-items:center;
            justify-content:center;
            cursor:grab;
            box-shadow:0 8px 20px rgba(0,0,0,0.06);
            transition:all 0.25s ease;
            user-select:none;
            border:2px solid rgba(66, 153, 225, 0.1);
            padding: 10px;
        }

        .library-item:hover {
            transform:translateY(-5px);
            box-shadow: 0 12px 25px rgba(0,0,0,0.15);
            border-color: rgba(66, 153, 225, 0.3);
        }

        .library-item.dragging {
            opacity:0.7;
            transform:scale(1.05) rotate(8deg);
            z-index:1200;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .library-icon {
            font-size:2.5rem;
            margin-bottom:8px;
        }

        .library-name {
            font-size:0.85rem;
            font-weight:700;
            color:#2d3748;
            text-align:center;
        }

        /* Control Buttons - Fixed visibility */
        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 2px solid #e2e8f0;
            background-color: #f0f7ff;
        }

        .control-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            min-width: 160px;
            justify-content: center;
        }

        .test-btn {
            background: linear-gradient(45deg,#38b2ac,#2c9a94);
            color: white;
        }

        .test-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(56, 178, 172, 0.4);
        }

        .clear-btn {
            background: linear-gradient(45deg,#e53e3e,#c53030);
            color: white;
        }

        .clear-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(229, 62, 62, 0.4);
        }

        .hint-btn {
            background: linear-gradient(45deg,#d69e2e,#b7791f);
            color: white;
        }

        .hint-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(214, 158, 46, 0.4);
        }

        /* Status Indicator */
        .status-indicator {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(66, 153, 225, 0.1);
            border: 2px solid rgba(66, 153, 225, 0.2);
            color: #2a69ac;
        }

        .status-indicator.on {
            background: rgba(56, 161, 105, 0.1);
            border-color: rgba(56, 161, 105, 0.3);
            color: #38a169;
            animation: statusPulse 2s infinite;
        }

        .status-indicator.off {
            background: rgba(229, 62, 62, 0.1);
            border-color: rgba(229, 62, 62, 0.2);
            color: #e53e3e;
        }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Connection Instructions */
        .connection-instruction {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 24px;
            border-radius: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            font-size: 0.95rem;
            color: #4a5568;
            display: none;
            align-items: center;
            gap: 12px;
            z-index: 1000;
            border: 2px solid #4299e1;
        }

        .connection-instruction.show {
            display: flex;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Analysis Panel */
        .analysis-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 2px solid #e2e8f0;
        }

        .analysis-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a365d;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .meter {
            width: 100%;
            height: 25px;
            background: #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
            border: 2px solid #cbd5e0;
        }

        .current-flow-meter {
            height: 100%;
            background: linear-gradient(90deg, #e53e3e, #ed8936, #38a169);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .readings {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            font-size: 0.9rem;
        }

        .reading-item {
            background: #f7fafc;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .reading-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 5px;
            font-size: 0.8rem;
        }

        .reading-value {
            font-weight: 700;
            color: #1a365d;
            font-size: 1.1rem;
        }

        /* Level Complete */
        .level-complete { 
            display:none; 
            text-align:center; 
            padding:28px; 
            background:linear-gradient(145deg,#ffffff,#f7fafc); 
            border-radius:20px; 
            box-shadow:0 20px 40px rgba(0,0,0,0.08); 
            max-width:700px; 
            margin:24px auto; 
        }
        
        .next-level-btn { 
            padding:12px 24px; 
            background:linear-gradient(45deg,#38b2ac,#2c9a94); 
            color:white; 
            border:none; 
            border-radius:12px; 
            font-weight:700; 
            cursor:pointer; 
            transition: all 0.3s ease; 
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px;
        }
        
        .next-level-btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(56, 178, 172, 0.4); 
        }

        .view-scores-btn {
            padding:12px 24px; 
            background:linear-gradient(45deg,#d69e2e,#b7791f); 
            color:white; 
            border:none; 
            border-radius:12px; 
            font-weight:700; 
            cursor:pointer; 
            transition: all 0.3s ease; 
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px;
        }

        .view-scores-btn:hover {
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(214, 158, 46, 0.4);
        }

        .start-real-game-btn {
            padding:12px 24px; 
            background:linear-gradient(45deg,#d69e2e,#b7791f); 
            color:white; 
            border:none; 
            border-radius:12px; 
            font-weight:700; 
            cursor:pointer; 
            transition: all 0.3s ease; 
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 10px;
        }

        .start-real-game-btn:hover {
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(214, 158, 46, 0.4);
        }

        /* Challenge Requirements */
        .challenge-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border: 2px solid #e2e8f0;
        }

        .requirements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .requirement-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .requirement-item.completed {
            background: rgba(56, 161, 105, 0.1);
            border-color: rgba(56, 161, 105, 0.3);
        }

        .requirement-icon {
            font-size: 1.5rem;
        }

        .requirement-text {
            flex: 1;
        }

        .requirement-name {
            font-weight: 600;
            color: #1a365d;
            font-size: 0.9rem;
        }

        .requirement-count {
            font-size: 0.8rem;
            color: #718096;
        }

        .requirement-check {
            color: #38a169;
            font-size: 1.2rem;
        }

        /* Hint System */
        .hint-system {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .hint-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            z-index: 2000;
            max-width: 500px;
            width: 90%;
            display: none;
        }

        .hint-popup.active {
            display: block;
            animation: popupIn 0.3s ease;
        }

        .hint-popup h3 {
            color: #2a69ac;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hint-popup p {
            color: #4a5568;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .hint-popup .hint-diagram {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            border: 2px dashed #cbd5e0;
        }

        .hint-popup .hint-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        .hint-popup button {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
        }

        .hint-popup .close-hint {
            background: #e2e8f0;
            color: #4a5568;
        }

        .hint-popup .close-hint:hover {
            background: #cbd5e0;
        }

        @keyframes popupIn {
            from { opacity: 0; transform: translate(-50%, -60%); }
            to { opacity: 1; transform: translate(-50%, -50%); }
        }

        /* Overlay for popup */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1999;
            display: none;
        }

        .popup-overlay.active {
            display: block;
        }

        /* Scoreboard - Fixed Layout */
        .scoreboard {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 4000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.5s ease;
            overflow: auto;
            padding: 20px;
        }

        .scoreboard.active {
            display: flex;
        }

        .scoreboard-content {
            background: white;
            border-radius: 25px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.5s ease;
            overflow: hidden;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .scoreboard-title {
            font-size: 2.2rem;
            color: #1a365d;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .scoreboard-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
            width: 100%;
        }

        .scoreboard-stat {
            background: #f7fafc;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e2e8f0;
            min-width: 0;
            overflow: hidden;
        }

        .scoreboard-stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 8px;
            color: #2a69ac;
            word-break: break-all;
            line-height: 1.2;
        }

        .scoreboard-stat-label {
            font-size: 0.9rem;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scoreboard-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .scoreboard-btn {
            padding: 14px 28px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
            font-size: 1rem;
        }

        .scoreboard-restart {
            background: linear-gradient(45deg, #38b2ac, #2c9a94);
            color: white;
        }

        .scoreboard-restart:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(56, 178, 172, 0.4);
        }

        .scoreboard-menu {
            background: linear-gradient(45deg, #d69e2e, #b7791f);
            color: white;
        }

        .scoreboard-menu:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(214, 158, 46, 0.4);
        }

        /* Short Circuit Effect */
        .short-circuit {
            animation: shortCircuit 0.5s ease;
        }

        @keyframes shortCircuit {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0;
            transition: all 0.3s ease;
            border-left: 4px solid #4299e1;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
            animation: toastIn 0.3s ease;
        }

        .toast.success {
            border-left-color: #38a169;
        }

        .toast.error {
            border-left-color: #e53e3e;
        }

        .toast.info {
            border-left-color: #4299e1;
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .game-container { 
                grid-template-columns: 1fr; 
                height: auto;
                gap: 20px;
            }
            
            .circuit-board {
                height: 400px;
            }
            
            .components-library {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .scoreboard-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .scoreboard-stat-value {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 768px) {
            .components-library {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .library-item {
                height: 90px;
            }
            
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .scoreboard-content {
                padding: 20px;
            }
            
            .scoreboard-stats {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .scoreboard-stat-value {
                font-size: 1.8rem;
            }
            
            .scoreboard-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .scoreboard-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .scoreboard-title {
                font-size: 1.8rem;
            }
        }
        
        @media (max-width: 480px) {
            .scoreboard-stat-value {
                font-size: 1.5rem;
            }
            
            .scoreboard-stat-label {
                font-size: 0.8rem;
            }
            
            .scoreboard-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="language-switcher">
        <button class="lang-btn active" data-lang="en">English</button>
        <button class="lang-btn" data-lang="or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
        <button class="lang-btn" data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
    </div>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon"><i class="fas fa-bolt"></i></div>
                    <div class="logo-text">STEM <span>Circuit</span> Builder</div>
                </div>

                <nav>
                    <ul>
                        <li><a href="student-dashboard.html" data-translate="nav-dashboard">Dashboard</a></li>
                        <li><a href="about.html" data-translate="nav-about">About</a></li>
                        <li><a href="contact.html" data-translate="nav-contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Instructions modal - SHOW FIRST -->
    <div class="instructions-modal" id="instructions-modal">
        <div class="instructions-content">
            <div class="language-switcher" style="position: relative; top: 0; right: 0; margin: 0 auto 20px auto; width: fit-content; background: rgba(26, 54, 93, 0.1);">
                <button class="lang-btn active" data-lang="en">English</button>
                <button class="lang-btn" data-lang="or">‡¨ì‡¨°‡¨º‡¨ø‡¨Ü</button>
                <button class="lang-btn" data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
            </div>
            
            <h2 class="instructions-title" id="instructions-title">How to Build Circuits</h2>
            <div class="instructions-text" id="instructions-text">
                <p id="instructions-intro">Welcome to Circuit Builder! Here's how to build circuits:</p>
                <ul class="instructions-list" id="instructions-list">
                    <li id="instruction-1">üì¶ Drag components from the library to the circuit board</li>
                    <li id="instruction-2">‚ö° Click on a terminal (colored dots) to start a connection</li>
                    <li id="instruction-3">üîó Click another terminal to complete the wire connection</li>
                    <li id="instruction-4">üîã Build complete circuits: Battery(+) ‚Üí Load(+) ‚Üí Load(-) ‚Üí Battery(-)</li>
                    <li id="instruction-5">üöÄ Click "Test Circuit" to see current flow</li>
                    <li id="instruction-6">üí° Connect switches between battery and load to control circuit</li>
                </ul>
                <p id="instructions-outro">Build working circuits to complete each challenge!</p>
            </div>
            <button class="start-game-btn" id="start-game-btn">Start Demo Level</button>
        </div>
    </div>

    <!-- Demo Overlay - HIDDEN UNTIL USER CLICKS "Start Demo Level" -->
    <div class="demo-overlay" id="demo-overlay">
        <div class="demo-step active" id="demo-step-1">
            <h3 id="demo-step-1-title">Welcome to Circuit Builder!</h3>
            <p id="demo-step-1-text">Let's learn how to build circuits step by step. Follow the highlighted elements.</p>
            <div class="demo-step-image">
                <i class="fas fa-bolt" style="color: #d69e2e; font-size: 5rem;"></i>
            </div>
            <p id="demo-step-1-desc">In this demo, we'll build a simple circuit with a battery and a bulb.</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="skip-demo">Skip Demo</button>
                <button class="demo-btn demo-next" id="next-demo-1">Let's Start!</button>
            </div>
        </div>

        <div class="demo-step" id="demo-step-2">
            <h3 id="demo-step-2-title">Step 1: Add a Battery</h3>
            <p id="demo-step-2-text">First, drag the <strong>Battery</strong> from the Components Library to the Circuit Board.</p>
            <div class="demo-step-image">
                <div style="font-size: 4rem;">üîã</div>
            </div>
            <p id="demo-step-2-desc">Look for the battery component in the library on the left.</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="back-demo-1">Back</button>
                <button class="demo-btn demo-next" id="next-demo-2">Got it!</button>
            </div>
        </div>

        <div class="demo-step" id="demo-step-3">
            <h3 id="demo-step-3-title">Step 2: Add a Light Bulb</h3>
            <p id="demo-step-3-text">Now drag the <strong>Light Bulb</strong> to the circuit board, next to the battery.</p>
            <div class="demo-step-image">
                <div style="font-size: 4rem;">üí°</div>
            </div>
            <p id="demo-step-3-desc">The bulb will light up when connected correctly to the battery.</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="back-demo-2">Back</button>
                <button class="demo-btn demo-next" id="next-demo-3">Next</button>
            </div>
        </div>

        <div class="demo-step" id="demo-step-4">
            <h3 id="demo-step-4-title">Step 3: Connect Positive Terminals</h3>
            <p id="demo-step-4-text">Click on the battery's <strong style="color: #e53e3e;">positive terminal (red +)</strong> first.</p>
            <div class="demo-step-image">
                <div style="display: flex; gap: 20px;">
                    <div style="width: 80px; height: 80px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üîã</div>
                    <div style="display: flex; align-items: center; font-size: 2rem; color: #d69e2e;">‚Üí</div>
                    <div style="width: 80px; height: 80px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üí°</div>
                </div>
            </div>
            <p id="demo-step-4-desc">Then click on the bulb's <strong style="color: #e53e3e;">positive terminal (red +)</strong> to create a wire.</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="back-demo-3">Back</button>
                <button class="demo-btn demo-next" id="next-demo-4">Next</button>
            </div>
        </div>

        <div class="demo-step" id="demo-step-5">
            <h3 id="demo-step-5-title">Step 4: Connect Negative Terminals</h3>
            <p id="demo-step-5-text">Click on the bulb's <strong style="color: #4299e1;">negative terminal (blue -)</strong> first.</p>
            <div class="demo-step-image">
                <div style="display: flex; gap: 20px;">
                    <div style="width: 80px; height: 80px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üí°</div>
                    <div style="display: flex; align-items: center; font-size: 2rem; color: #d69e2e;">‚Üí</div>
                    <div style="width: 80px; height: 80px; background: white; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">üîã</div>
                </div>
            </div>
            <p id="demo-step-5-desc">Then click on the battery's <strong style="color: #4299e1;">negative terminal (blue -)</strong> to complete the circuit.</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="back-demo-4">Back</button>
                <button class="demo-btn demo-next" id="next-demo-5">Next</button>
            </div>
        </div>

        <div class="demo-step" id="demo-step-6">
            <h3 id="demo-step-6-title">Step 5: Test Your Circuit</h3>
            <p id="demo-step-6-text">Click the <strong style="color: #38b2ac;">"Test Circuit"</strong> button to see if electricity flows.</p>
            <div class="demo-step-image">
                <i class="fas fa-play-circle" style="color: #38b2ac; font-size: 5rem;"></i>
            </div>
            <p id="demo-step-6-desc">If everything is connected correctly, you'll see current flowing and the bulb will light up!</p>
            <div class="demo-buttons">
                <button class="demo-btn demo-skip" id="back-demo-5">Back</button>
                <button class="demo-btn demo-start-game" id="complete-demo">Start Real Game!</button>
            </div>
        </div>
    </div>

    <!-- Post-Demo Message -->
    <div class="post-demo-message" id="post-demo-message">
        <div class="post-demo-icon">
            <i class="fas fa-graduation-cap"></i>
        </div>
        <h2 id="post-demo-title">Demo Completed!</h2>
        <p id="post-demo-text" style="color: #4a5568; margin: 20px 0; font-size: 1.1rem; line-height: 1.6;">
            Great job! You've learned how to build basic circuits. Now you're ready for the real game challenges!
        </p>
        <div style="background: #f7fafc; padding: 20px; border-radius: 15px; margin: 25px 0; border: 2px solid #e2e8f0;">
            <h3 id="post-demo-next-title" style="color: #2a69ac; margin-bottom: 15px;">What's Next?</h3>
            <ul id="post-demo-list" style="text-align: left; color: #4a5568; margin-left: 20px;">
                <li style="margin-bottom: 10px;"><strong>Level 1:</strong> Simple circuit with timer</li>
                <li style="margin-bottom: 10px;"><strong>Level 2:</strong> Circuit with switch control</li>
                <li style="margin-bottom: 10px;"><strong>Level 3:</strong> Motor circuit challenge</li>
                <li><strong>Level 4:</strong> Complete circuit with all components</li>
            </ul>
        </div>
        <div class="post-demo-buttons">
            <button class="control-btn test-btn" id="start-real-game-btn">
                <i class="fas fa-play-circle"></i>
                Start Real Game
            </button>
            <button class="control-btn hint-btn" id="repeat-demo-btn">
                <i class="fas fa-redo"></i>
                Repeat Demo
            </button>
        </div>
    </div>

    <!-- Scoreboard -->
    <div class="scoreboard" id="scoreboard">
        <div class="scoreboard-content">
            <h2 class="scoreboard-title" id="scoreboard-title">Game Completed!</h2>
            <div style="font-size: 5rem; color: #d69e2e; margin: 20px 0;">
                <i class="fas fa-trophy"></i>
            </div>
            <p id="scoreboard-message" style="color: #4a5568; font-size: 1.2rem; margin-bottom: 30px;">
                Congratulations! You've completed all levels.
            </p>
            <div class="scoreboard-stats">
                <div class="scoreboard-stat">
                    <div class="scoreboard-stat-value" id="final-total-score">0</div>
                    <div class="scoreboard-stat-label" id="scoreboard-total-label">Total Score</div>
                </div>
                <div class="scoreboard-stat">
                    <div class="scoreboard-stat-value" id="final-levels-completed">0/4</div>
                    <div class="scoreboard-stat-label" id="scoreboard-levels-label">Levels Completed</div>
                </div>
                <div class="scoreboard-stat">
                    <div class="scoreboard-stat-value" id="final-total-time">0s</div>
                    <div class="scoreboard-stat-label" id="scoreboard-time-label">Total Time</div>
                </div>
                <div class="scoreboard-stat">
                    <div class="scoreboard-stat-value" id="final-perfect-circuits">0</div>
                    <div class="scoreboard-stat-label" id="scoreboard-perfect-label">Perfect Circuits</div>
                </div>
            </div>
            <div class="scoreboard-buttons">
                <button class="scoreboard-btn scoreboard-restart" id="scoreboard-restart">
                    <i class="fas fa-redo"></i>
                    Play Again
                </button>
                <button class="scoreboard-btn scoreboard-menu" id="scoreboard-menu">
                    <i class="fas fa-home"></i>
                    Main Menu
                </button>
            </div>
        </div>
    </div>

    <!-- Hint System -->
    <div class="popup-overlay" id="popup-overlay"></div>
    <div class="hint-popup" id="hint-popup">
        <h3><i class="fas fa-lightbulb"></i> <span id="hint-title">Circuit Hint</span></h3>
        <div id="hint-content">
            <!-- Hint content will be loaded here -->
        </div>
        <div class="hint-buttons">
            <button class="close-hint" id="close-hint">Got it!</button>
        </div>
    </div>

    <!-- Game header -->
    <section class="game-header" style="display:none;" id="game-header">
        <div class="container">
            <h1 data-translate="game-title">Interactive Circuit Builder</h1>
            <p data-translate="game-desc">Build real circuits! Drag components, connect terminals with wires, and watch electricity flow from positive to negative.</p>
        </div>
    </section>

    <!-- Game stats -->
    <div class="container" style="display:none;" id="game-stats-container">
        <div class="game-stats">
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span id="time">05:00</span>
            </div>

            <div class="score">
                <i class="fas fa-star"></i>
                <span id="score">Score: 0</span>
            </div>

            <div class="hints">
                <i class="fas fa-fire"></i>
                <span id="streak">Streak: 0</span>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress" style="width:0%"></div>
            </div>
        </div>
    </div>

    <!-- Game area -->
    <section class="game-area" style="display:none;" id="game-area">
        <div class="container">
            <div class="game-container">
                <!-- Components Library -->
                <div class="components-zone">
                    <div class="zone-header">
                        <div class="zone-icon components-icon"><i class="fas fa-toolbox"></i></div>
                        <h2 class="zone-title" data-translate="components-library">Components Library</h2>
                    </div>
                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 15px;">Drag components to the circuit board</p>
                    <div class="components-library" id="components-library">
                        <!-- Components loaded here -->
                    </div>
                </div>

                <!-- Circuit Board Zone -->
                <div class="circuit-zone">
                    <div class="circuit-header">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div class="zone-icon circuit-icon"><i class="fas fa-microchip"></i></div>
                            <h2 class="zone-title" data-translate="circuit-board">Circuit Board</h2>
                        </div>
                        <div class="status-indicator off" id="circuit-status">
                            <i class="fas fa-times-circle"></i>
                            <span>No Circuit</span>
                        </div>
                    </div>
                    
                    <!-- Connection Instruction -->
                    <div class="connection-instruction" id="connection-instruction">
                        <i class="fas fa-mouse-pointer"></i>
                        <span id="connection-text">Click another terminal to connect</span>
                        <button id="cancel-connection" style="margin-left: auto; background: none; border: none; color: #e53e3e; cursor: pointer; font-size: 0.9rem;">
                            <i class="fas fa-times"></i> ESC
                        </button>
                    </div>
                    
                    <!-- Wire Helper -->
                    <div class="wire-helper" id="wire-helper"></div>
                    
                    <!-- Circuit Board -->
                    <div class="circuit-board" id="circuit-board">
                        <!-- Components and wires appear here -->
                    </div>
                    
                    <!-- Analysis Panel -->
                    <div class="analysis-panel">
                        <div class="analysis-title">
                            <i class="fas fa-chart-line"></i>
                            <span>Circuit Analysis</span>
                        </div>
                        <div class="meter">
                            <div class="current-flow-meter" id="current-meter"></div>
                        </div>
                        <div class="readings">
                            <div class="reading-item">
                                <div class="reading-label">VOLTAGE</div>
                                <div class="reading-value" id="voltage-reading">0V</div>
                            </div>
                            <div class="reading-item">
                                <div class="reading-label">CURRENT</div>
                                <div class="reading-value" id="current-reading">0mA</div>
                            </div>
                            <div class="reading-item">
                                <div class="reading-label">STATUS</div>
                                <div class="reading-value" id="status-reading">Open</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Control Buttons -->
            <div class="control-buttons">
                <button class="control-btn test-btn" id="test-circuit-btn">
                    <i class="fas fa-play"></i>
                    <span id="test-btn-text">Test Circuit</span>
                </button>
                <button class="control-btn clear-btn" id="clear-circuit-btn">
                    <i class="fas fa-trash"></i>
                    <span id="clear-btn-text">Clear Board</span>
                </button>
                <button class="control-btn hint-btn" id="hint-btn">
                    <i class="fas fa-lightbulb"></i>
                    <span id="hint-btn-text">Get Hint</span>
                </button>
            </div>

            <!-- Challenge Requirements -->
            <div class="challenge-section" id="challenge-section">
                <h2 class="level-title" id="challenge-title">Demo Level: Build Your First Circuit</h2>
                <p class="level-text" id="challenge-description">
                    Follow the step-by-step guide to build a working circuit. Connect battery (+) to bulb (+), bulb (-) to battery (-).
                </p>
                <div class="requirements-grid" id="requirements-grid">
                    <!-- Requirements loaded here -->
                </div>
            </div>

            <!-- Level Complete -->
            <div class="level-complete" id="level-complete" style="display: none;">
                <div style="font-size: 4rem; color: #d69e2e; margin-bottom: 20px;">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2 style="font-size: 2rem; color: #1a365d; margin-bottom: 15px;" id="complete-title">Level Complete!</h2>
                <p style="color: #4a5568; margin-bottom: 25px; font-size: 1.1rem;" id="level-complete-text">
                    Great job! Your circuit is working perfectly.
                </p>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 30px 0;">
                    <div>
                        <div style="font-size: 2.5rem; color: #38a169; font-weight: 800;" id="final-score">+100</div>
                        <div style="font-size: 0.9rem; color: #718096;">SCORE</div>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem; color: #4299e1; font-weight: 800;" id="final-time">45s</div>
                        <div style="font-size: 0.9rem; color: #718096;">TIME</div>
                    </div>
                    <div>
                        <div style="font-size: 2.5rem; color: #d69e2e; font-weight: 800;" id="final-streak">3</div>
                        <div style="font-size: 0.9rem; color: #718096;">STREAK</div>
                    </div>
                </div>
                <div id="level-complete-buttons">
                    <!-- Buttons will be added dynamically -->
                </div>
            </div>
        </div>
    </section>

    <script>
        // Complete Circuit Components Data
        const circuitComponents = [
            { 
                id: 1, 
                name: { en: "Battery", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä" }, 
                icon: "üîã", 
                type: "power", 
                voltage: 9,
                terminals: [
                    { id: "positive", type: "positive", label: "+", position: "right", color: "#e53e3e", x: 90, y: 40 },
                    { id: "negative", type: "negative", label: "-", position: "left", color: "#4299e1", x: 10, y: 60 }
                ],
                info: { en: "9V Battery - Provides electrical energy", or: "9V ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä - ‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§ ‡¨∂‡¨ï‡≠ç‡¨§‡¨ø ‡¨Ø‡≠ã‡¨ó‡¨æ‡¨è", hi: "9V ‡§¨‡•à‡§ü‡§∞‡•Ä - ‡§µ‡§ø‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à" }
            },
            { 
                id: 2, 
                name: { en: "Light Bulb", or: "‡¨¨‡¨≤‡≠ç‡¨¨", hi: "‡§¨‡§≤‡•ç‡§¨" }, 
                icon: "üí°", 
                type: "load", 
                voltage: 3,
                terminals: [
                    { id: "positive", type: "positive", label: "+", position: "top", color: "#e53e3e", x: 50, y: 15 },
                    { id: "negative", type: "negative", label: "-", position: "bottom", color: "#4299e1", x: 50, y: 85 }
                ],
                info: { en: "Light Bulb - Converts electrical energy to light", or: "‡¨¨‡¨≤‡≠ç‡¨¨ - ‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§ ‡¨∂‡¨ï‡≠ç‡¨§‡¨ø‡¨ï‡≠Å ‡¨Ü‡¨≤‡≠ã‡¨ï‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨£‡¨§ ‡¨ï‡¨∞‡≠á", hi: "‡§¨‡§≤‡•ç‡§¨ - ‡§µ‡§ø‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§§‡§æ ‡§π‡•à" }
            },
            { 
                id: 3, 
                name: { en: "Switch", or: "‡¨∏‡≠Å‡¨á‡¨ö‡≠ç", hi: "‡§∏‡•ç‡§µ‡§ø‡§ö" }, 
                icon: "‚ö°", 
                type: "control", 
                voltage: 0,
                terminals: [
                    { id: "in", type: "neutral", label: "IN", position: "left", color: "#718096", x: 15, y: 50 },
                    { id: "out", type: "neutral", label: "OUT", position: "right", color: "#718096", x: 85, y: 50 }
                ],
                info: { en: "Toggle Switch - Controls current flow", or: "‡¨∏‡≠Å‡¨á‡¨ö‡≠ç - ‡¨ï‡¨∞‡≠á‡¨£‡≠ç‡¨ü ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π‡¨ï‡≠Å ‡¨®‡¨ø‡≠ü‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£ ‡¨ï‡¨∞‡≠á", hi: "‡§∏‡•ç‡§µ‡§ø‡§ö - ‡§ï‡§∞‡§Ç‡§ü ‡§™‡•ç‡§∞‡§µ‡§æ‡§π ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à" }
            },
            { 
                id: 4, 
                name: { en: "Motor", or: "‡¨Æ‡≠ã‡¨ü‡¨∞", hi: "‡§Æ‡•ã‡§ü‡§∞" }, 
                icon: "üîÑ", 
                type: "load", 
                voltage: 6,
                terminals: [
                    { id: "positive", type: "positive", label: "+", position: "left", color: "#e53e3e", x: 20, y: 40 },
                    { id: "negative", type: "negative", label: "-", position: "right", color: "#4299e1", x: 80, y: 60 }
                ],
                info: { en: "DC Motor - Converts electrical to mechanical energy", or: "DC ‡¨Æ‡≠ã‡¨ü‡¨∞ - ‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§‡¨ï‡≠Å ‡¨Ø‡¨æ‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨ø‡¨ï ‡¨∂‡¨ï‡≠ç‡¨§‡¨ø‡¨∞‡≠á ‡¨™‡¨∞‡¨ø‡¨£‡¨§ ‡¨ï‡¨∞‡≠á", hi: "DC ‡§Æ‡•ã‡§ü‡§∞ - ‡§µ‡§ø‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§ï‡•ã ‡§Ø‡§æ‡§Ç‡§§‡•ç‡§∞‡§ø‡§ï ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§§‡•Ä ‡§π‡•à" }
            },
            { 
                id: 5, 
                name: { en: "Resistor", or: "‡¨∞‡≠á‡¨ú‡¨ø‡¨∑‡≠ç‡¨ü‡¨∞", hi: "‡§∞‡•ã‡§ï‡§®‡•á‡§µ‡§æ‡§≤‡§æ" }, 
                icon: "‚èö", 
                type: "resistance", 
                voltage: 0,
                terminals: [
                    { id: "end1", type: "neutral", label: "‚Ä¢", position: "left", color: "#718096", x: 20, y: 50 },
                    { id: "end2", type: "neutral", label: "‚Ä¢", position: "right", color: "#718096", x: 85, y: 50 }
                ],
                info: { en: "Resistor - Limits current flow", or: "‡¨∞‡≠á‡¨ú‡¨ø‡¨∑‡≠ç‡¨ü‡¨∞ - ‡¨ï‡¨∞‡≠á‡¨£‡≠ç‡¨ü ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π‡¨ï‡≠Å ‡¨∏‡≠Ä‡¨Æ‡¨ø‡¨§ ‡¨ï‡¨∞‡≠á", hi: "‡§∞‡•ã‡§ï‡§®‡•á‡§µ‡§æ‡§≤‡§æ - ‡§ï‡§∞‡§Ç‡§ü ‡§™‡•ç‡§∞‡§µ‡§æ‡§π ‡§ï‡•ã ‡§∏‡•Ä‡§Æ‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à" }
            }
        ];

        // Game Levels
        const gameLevels = [
            {
                id: 0,
                title: { en: "Demo: Learn to Build Circuits", or: "‡¨°‡≠á‡¨Æ‡≠ã: ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨∂‡¨ø‡¨ñ‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§°‡•á‡§Æ‡•ã: ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§®‡§æ ‡§∏‡•Ä‡§ñ‡•á‡§Ç" },
                description: { 
                    en: "Follow the step-by-step guide to build your first circuit. This is a learning level with no time limit.",
                    or: "‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨™‡≠ç‡¨∞‡¨•‡¨Æ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡¨Ö‡¨®‡≠Å‡¨∏‡¨æ‡¨∞‡≠á ‡¨ó‡¨æ‡¨á‡¨°‡≠ç ‡¨Ö‡¨®‡≠Å‡¨∏‡¨∞‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å",
                    hi: "‡§Ö‡§™‡§®‡§æ ‡§™‡§π‡§≤‡§æ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ö‡§∞‡§£-d‡§¶‡§∞-‡§ö‡§∞‡§£ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§ø‡§ï‡§æ ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡•á‡§Ç"
                },
                requirements: [
                    { type: "power", count: 1, name: "Battery" },
                    { type: "load", count: 1, name: "Light Bulb" }
                ],
                points: 50,
                timeLimit: 0,
                isDemo: true,
                hints: [
                    { en: "Start by dragging a battery from the components library to the circuit board", or: "‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á ‡¨ï‡¨Æ‡≠ç‡¨™‡≠ã‡¨®‡≠á‡¨£‡≠ç‡¨ü ‡¨≤‡¨æ‡¨á‡¨¨‡≠ç‡¨∞‡≠á‡¨∞‡≠Ä‡¨∞‡≠Å ‡¨è‡¨ï ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡≠ã‡¨∞‡≠ç‡¨°‡¨ï‡≠Å ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§™‡§π‡§≤‡•á ‡§ò‡§ü‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§∏‡•á ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç" },
                    { en: "Drag a light bulb next to the battery", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨æ‡¨ñ‡¨∞‡≠á ‡¨è‡¨ï ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•á ‡§¨‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§¨‡§≤‡•ç‡§¨ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç" },
                    { en: "Connect battery positive (+) to bulb positive (+) by clicking on the red terminals", or: "‡¨≤‡¨æ‡¨≤‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç (+) ‡¨ï‡≠Å ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç (+) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§≤‡§æ‡§≤ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤‡•ã‡§Ç ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ (+) ‡§ï‡•ã ‡§¨‡§≤‡•ç‡§¨ ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ (+) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect bulb negative (-) to battery negative (-) by clicking on the blue terminals", or: "‡¨®‡≠Ä‡¨≥ ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç (-) ‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç (-) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§®‡•Ä‡§≤‡•á ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤‡•ã‡§Ç ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§¨‡§≤‡•ç‡§¨ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ (-) ‡§ï‡•ã ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ (-) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Click 'Test Circuit' to check if your circuit works", or: "‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡≠Å‡¨õ‡¨ø ‡¨ï‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡¨ï‡≠Å '‡¨ü‡≠á‡¨∑‡≠ç‡¨ü ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç' ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§Ø‡§π ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è '‡§ü‡•á‡§∏‡•ç‡§ü ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü' ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡§æ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç" }
                ]
            },
            {
                id: 1,
                title: { en: "Level 1: Simple Circuit", or: "‡¨∏‡≠ç‡¨§‡¨∞ ‡≠ß: ‡¨∏‡¨∞‡¨≥ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç", hi: "‡§∏‡•ç‡§§‡§∞ 1: ‡§∏‡§∞‡§≤ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü" },
                description: { 
                    en: "Build a simple circuit: Connect battery to bulb with wires. Remember: Current flows from positive (+) to negative (-).",
                    or: "‡¨è‡¨ï ‡¨∏‡¨∞‡¨≥ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä‡¨ï‡≠Å ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨∏‡¨π‡¨ø‡¨§ ‡¨§‡¨æ‡¨∞‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å",
                    hi: "‡§è‡§ï ‡§∏‡§∞‡§≤ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç: ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•ã ‡§¨‡§≤‡•ç‡§¨ ‡§∏‡•á ‡§§‡§æ‡§∞‡•ã‡§Ç ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡•á‡§Ç"
                },
                requirements: [
                    { type: "power", count: 1, name: "Battery" },
                    { type: "load", count: 1, name: "Light Bulb" }
                ],
                points: 100,
                timeLimit: 300,
                isDemo: false,
                unlocked: true,
                hints: [
                    { en: "You need 1 battery and 1 light bulb for this level", or: "‡¨è‡¨π‡¨ø ‡¨∏‡≠ç‡¨§‡¨∞ ‡¨™‡¨æ‡¨á‡¨Å ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡≠Å 1 ‡¨ü‡¨ø ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨è‡¨¨‡¨Ç 1 ‡¨ü‡¨ø ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨¶‡¨∞‡¨ï‡¨æ‡¨∞", hi: "‡§á‡§∏ ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã 1 ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§î‡§∞ 1 ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à" },
                    { en: "Connect battery positive (+) to bulb positive (+)", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç (+) ‡¨ï‡≠Å ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç (+) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ (+) ‡§ï‡•ã ‡§¨‡§≤‡•ç‡§¨ ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ (+) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect bulb negative (-) to battery negative (-)", or: "‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç (-) ‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç (-) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡§≤‡•ç‡§¨ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ (-) ‡§ï‡•ã ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ (-) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Make sure all connections are complete before testing", or: "‡¨™‡¨∞‡≠Ä‡¨ï‡≠ç‡¨∑‡¨æ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡≠Ç‡¨∞‡≠ç‡¨¨‡¨∞‡≠Å ‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§ü‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§∏‡§≠‡•Ä ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•Ç‡§∞‡•á ‡§π‡•à‡§Ç" },
                    { en: "Electricity flows from positive to negative terminals", or: "‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§‡≠ç ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∞‡≠Å ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç ‡¨™‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨®‡≠ç‡¨§ ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π‡¨ø‡¨§ ‡¨π‡≠Å‡¨è", hi: "‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§∏‡•á ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤‡•ã‡§Ç ‡§§‡§ï ‡§¨‡§π‡§§‡•Ä ‡§π‡•à" }
                ]
            },
            {
                id: 2,
                title: { en: "Level 2: Circuit with Switch", or: "‡¨∏‡≠ç‡¨§‡¨∞ ‡≠®: ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç", hi: "‡§∏‡•ç‡§§‡§∞ 2: ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü" },
                description: { 
                    en: "Add a switch to control the circuit. Connect switch between battery and bulb.",
                    or: "‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨®‡¨ø‡≠ü‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨è‡¨ï ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç ‡¨Ø‡≠ã‡¨°‡¨®‡≠ç‡¨§‡≠Å",
                    hi: "‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§ú‡•ã‡§°‡§º‡•á‡§Ç"
                },
                requirements: [
                    { type: "power", count: 1, name: "Battery" },
                    { type: "load", count: 1, name: "Light Bulb" },
                    { type: "control", count: 1, name: "Switch" }
                ],
                points: 150,
                timeLimit: 300,
                isDemo: false,
                unlocked: false,
                hints: [
                    { en: "Place the switch between the battery and bulb", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨è‡¨¨‡¨Ç ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨∞‡≠á ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§î‡§∞ ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§∞‡§ñ‡•á‡§Ç" },
                    { en: "Connect battery positive to switch IN terminal", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç IN ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§∏‡•ç‡§µ‡§ø‡§ö IN ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect switch OUT terminal to bulb positive", or: "‡¨∏‡≠Å‡¨á‡¨ö‡≠ç OUT ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç ‡¨ï‡≠Å ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§∏‡•ç‡§µ‡§ø‡§ö OUT ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§ï‡•ã ‡§¨‡§≤‡•ç‡§¨ ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect bulb negative to battery negative", or: "‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡§≤‡•ç‡§¨ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Switches have no polarity - IN/OUT terminals can connect either way", or: "‡¨∏‡≠Å‡¨á‡¨ö‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡¨∞ ‡¨™‡≠ã‡¨≤‡¨æ‡¨∞‡¨ø‡¨ü‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å - IN/OUT ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï ‡¨Ø‡≠á‡¨ï‡≠å‡¨£‡¨∏‡¨ø ‡¨â‡¨™‡¨æ‡≠ü‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨π‡≠ã‡¨á‡¨™‡¨æ‡¨∞‡≠á", hi: "‡§∏‡•ç‡§µ‡§ø‡§ö ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§™‡•ã‡§≤‡•à‡§∞‡§ø‡§ü‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä - IN/OUT ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§ú‡•Å‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç" }
                ]
            },
            {
                id: 3,
                title: { en: "Level 3: Motor Circuit", or: "‡¨∏‡≠ç‡¨§‡¨∞ ‡≠©: ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç", hi: "‡§∏‡•ç‡§§‡§∞ 3: ‡§Æ‡•ã‡§ü‡§∞ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü" },
                description: { 
                    en: "Build a circuit with a motor. The motor converts electrical energy to motion.",
                    or: "‡¨è‡¨ï ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å",
                    hi: "‡§Æ‡•ã‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç"
                },
                requirements: [
                    { type: "power", count: 1, name: "Battery" },
                    { type: "load", count: 1, name: "Motor" }
                ],
                points: 200,
                timeLimit: 300,
                isDemo: false,
                unlocked: false,
                hints: [
                    { en: "Motors work just like bulbs - they need positive and negative connections", or: "‡¨Æ‡≠ã‡¨ü‡¨∞‡¨ó‡≠Å‡¨°‡¨ø‡¨ï ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨™‡¨∞‡¨ø ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡≠á - ‡¨∏‡≠á‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨è‡¨¨‡¨Ç ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨¶‡¨∞‡¨ï‡¨æ‡¨∞", hi: "‡§Æ‡•ã‡§ü‡§∞ ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡§Ç - ‡§â‡§®‡•ç‡§π‡•á‡§Ç ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§î‡§∞ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à" },
                    { en: "Connect battery positive to motor positive (red terminal)", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç (‡¨≤‡¨æ‡¨≤‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§Æ‡•ã‡§ü‡§∞ ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ (‡§≤‡§æ‡§≤ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect motor negative to battery negative (blue terminal)", or: "‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç (‡¨®‡≠Ä‡¨≥ ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç) ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§Æ‡•ã‡§ü‡§∞ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ (‡§®‡•Ä‡§≤‡§æ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤) ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Make sure connections are tight for the motor to spin", or: "‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨ò‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£‡¨® ‡¨™‡¨æ‡¨á‡¨Å ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó‡¨ó‡≠Å‡¨°‡¨ø‡¨ï ‡¨ü‡¨æ‡¨£ ‡¨Ö‡¨õ‡¨ø ‡¨ï‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡¨®‡¨ø‡¨∂‡≠ç‡¨ö‡¨ø‡¨§ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§Æ‡•ã‡§ü‡§∞ ‡§ï‡•á ‡§ò‡•Ç‡§Æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ü‡§æ‡§á‡§ü ‡§π‡•à‡§Ç" },
                    { en: "If motor doesn't work, check all connections are complete", or: "‡¨Ø‡¨¶‡¨ø ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡≠á ‡¨®‡¨æ‡¨π‡¨ø‡¨Å, ‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨Ö‡¨õ‡¨ø ‡¨ï‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡¨Ø‡¨æ‡¨û‡≠ç‡¨ö ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§Ø‡§¶‡§ø ‡§Æ‡•ã‡§ü‡§∞ ‡§ï‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø ‡§∏‡§≠‡•Ä ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•Ç‡§∞‡•á ‡§π‡•à‡§Ç" }
                ]
            },
            {
                id: 4,
                title: { en: "Level 4: Complete Circuit", or: "‡¨∏‡≠ç‡¨§‡¨∞ ‡≠™: ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç", hi: "‡§∏‡•ç‡§§‡§∞ 4: ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü" },
                description: { 
                    en: "Build a complete circuit with battery, bulb, switch and motor. Test your skills!",
                    or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä, ‡¨¨‡¨≤‡≠ç‡¨¨, ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç ‡¨è‡¨¨‡¨Ç ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨∏‡¨π‡¨ø‡¨§ ‡¨è‡¨ï ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å",
                    hi: "‡§¨‡•à‡§ü‡§∞‡•Ä, ‡§¨‡§≤‡•ç‡§¨, ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§î‡§∞ ‡§Æ‡•ã‡§ü‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç"
                },
                requirements: [
                    { type: "power", count: 1, name: "Battery" },
                    { type: "load", count: 1, name: "Light Bulb" },
                    { type: "load", count: 1, name: "Motor" },
                    { type: "control", count: 1, name: "Switch" }
                ],
                points: 300,
                timeLimit: 400,
                isDemo: false,
                unlocked: false,
                hints: [
                    { en: "Place all components: Battery, Bulb, Motor, and Switch", or: "‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨ï‡¨Æ‡≠ç‡¨™‡≠ã‡¨®‡≠á‡¨£‡≠ç‡¨ü ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å: ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä, ‡¨¨‡¨≤‡≠ç‡¨¨, ‡¨Æ‡≠ã‡¨ü‡¨∞, ‡¨è‡¨¨‡¨Ç ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç", hi: "‡§∏‡§≠‡•Ä ‡§ò‡§ü‡§ï ‡§∞‡§ñ‡•á‡§Ç: ‡§¨‡•à‡§ü‡§∞‡•Ä, ‡§¨‡§≤‡•ç‡§¨, ‡§Æ‡•ã‡§ü‡§∞ ‡§î‡§∞ ‡§∏‡•ç‡§µ‡§ø‡§ö" },
                    { en: "Connect battery positive to switch IN", or: "‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç IN ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡•à‡§ü‡§∞‡•Ä ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§∏‡•ç‡§µ‡§ø‡§ö IN ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect switch OUT to both bulb and motor positives", or: "‡¨∏‡≠Å‡¨á‡¨ö‡≠ç OUT ‡¨ï‡≠Å ‡¨â‡¨≠‡≠ü ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨è‡¨¨‡¨Ç ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§∏‡•ç‡§µ‡§ø‡§ö OUT ‡§ï‡•ã ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§¨‡§≤‡•ç‡§¨ ‡§î‡§∞ ‡§Æ‡•ã‡§ü‡§∞ ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "Connect bulb negative and motor negative to battery negative", or: "‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨è‡¨¨‡¨Ç ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å", hi: "‡§¨‡§≤‡•ç‡§¨ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§î‡§∞ ‡§Æ‡•ã‡§ü‡§∞ ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ï‡•ã ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç" },
                    { en: "All loads should be connected in parallel with the battery", or: "‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨≤‡≠ã‡¨°‡≠ç ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Æ‡¨æ‡¨®‡≠ç‡¨§‡¨∞‡¨æ‡¨≥‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨π‡≠á‡¨¨‡¨æ ‡¨â‡¨ö‡¨ø‡¨§‡≠ç", hi: "‡§∏‡§≠‡•Ä ‡§≤‡•ã‡§° ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§æ‡§®‡§æ‡§Ç‡§§‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•Å‡§°‡§º‡•á ‡§π‡•ã‡§®‡•á ‡§ö‡§æ‡§π‡§ø‡§è" }
                ]
            }
        ];

        // Game State
        let currentLanguage = 'en';
        let score = 0;
        let streak = 0;
        let timeLeft = 0;
        let timerInterval = null;
        let currentLevel = 0;
        let placedComponents = [];
        let wires = [];
        let selectedTerminal = null;
        let isTesting = false;
        let currentFlowInterval = null;
        let levelStartTime = null;
        let levelCompleted = false;
        
        // Demo State
        let demoStep = 1;
        let isDemoMode = false;
        let demoCompleted = false;
        let perfectCircuits = 0;
        let totalTimePlayed = 0;
        let levelsCompleted = 0;

        // DOM Elements
        const componentsLibrary = document.getElementById('components-library');
        const circuitBoard = document.getElementById('circuit-board');
        const scoreElement = document.getElementById('score');
        const timeElement = document.getElementById('time');
        const streakElement = document.getElementById('streak');
        const progressElement = document.getElementById('progress');
        const circuitStatusElement = document.getElementById('circuit-status');
        const currentMeter = document.getElementById('current-meter');
        const voltageReading = document.getElementById('voltage-reading');
        const currentReading = document.getElementById('current-reading');
        const statusReading = document.getElementById('status-reading');
        const connectionInstruction = document.getElementById('connection-instruction');
        const wireHelper = document.getElementById('wire-helper');
        const challengeDescription = document.getElementById('challenge-description');
        const requirementsGrid = document.getElementById('requirements-grid');
        const challengeTitle = document.getElementById('challenge-title');
        const demoOverlay = document.getElementById('demo-overlay');
        const postDemoMessage = document.getElementById('post-demo-message');
        const levelComplete = document.getElementById('level-complete');
        const completeTitle = document.getElementById('complete-title');
        const gameHeader = document.getElementById('game-header');
        const gameStatsContainer = document.getElementById('game-stats-container');
        const gameArea = document.getElementById('game-area');
        const instructionsModal = document.getElementById('instructions-modal');
        const hintPopup = document.getElementById('hint-popup');
        const popupOverlay = document.getElementById('popup-overlay');
        const hintContent = document.getElementById('hint-content');
        const closeHint = document.getElementById('close-hint');
        const scoreboard = document.getElementById('scoreboard');
        const finalTotalScore = document.getElementById('final-total-score');
        const finalLevelsCompleted = document.getElementById('final-levels-completed');
        const finalTotalTime = document.getElementById('final-total-time');
        const finalPerfectCircuits = document.getElementById('final-perfect-circuits');
        const levelCompleteButtons = document.getElementById('level-complete-buttons');

        // Demo Content Translations
        const demoTranslations = {
            en: {
                'demo-step-1-title': 'Welcome to Circuit Builder!',
                'demo-step-1-text': 'Let\'s learn how to build circuits step by step. Follow the highlighted elements.',
                'demo-step-1-desc': 'In this demo, we\'ll build a simple circuit with a battery and a bulb.',
                'demo-step-2-title': 'Step 1: Add a Battery',
                'demo-step-2-text': 'First, drag the <strong>Battery</strong> from the Components Library to the Circuit Board.',
                'demo-step-2-desc': 'Look for the battery component in the library on the left.',
                'demo-step-3-title': 'Step 2: Add a Light Bulb',
                'demo-step-3-text': 'Now drag the <strong>Light Bulb</strong> to the circuit board, next to the battery.',
                'demo-step-3-desc': 'The bulb will light up when connected correctly to the battery.',
                'demo-step-4-title': 'Step 3: Connect Positive Terminals',
                'demo-step-4-text': 'Click on the battery\'s <strong style="color: #e53e3e;">positive terminal (red +)</strong> first.',
                'demo-step-4-desc': 'Then click on the bulb\'s <strong style="color: #e53e3e;">positive terminal (red +)</strong> to create a wire.',
                'demo-step-5-title': 'Step 4: Connect Negative Terminals',
                'demo-step-5-text': 'Click on the bulb\'s <strong style="color: #4299e1;">negative terminal (blue -)</strong> first.',
                'demo-step-5-desc': 'Then click on the battery\'s <strong style="color: #4299e1;">negative terminal (blue -)</strong> to complete the circuit.',
                'demo-step-6-title': 'Step 5: Test Your Circuit',
                'demo-step-6-text': 'Click the <strong style="color: #38b2ac;">"Test Circuit"</strong> button to see if electricity flows.',
                'demo-step-6-desc': 'If everything is connected correctly, you\'ll see current flowing and the bulb will light up!',
                'skip-demo': 'Skip Demo',
                'back': 'Back',
                'next': 'Next',
                'got-it': 'Got it!',
                'lets-start': 'Let\'s Start!',
                'complete-demo': 'Start Real Game!',
                'post-demo-title': 'Demo Completed!',
                'post-demo-text': 'Great job! You\'ve learned how to build basic circuits. Now you\'re ready for the real game challenges!',
                'post-demo-next-title': 'What\'s Next?',
                'post-demo-list-item-1': 'Level 1: Simple circuit with timer',
                'post-demo-list-item-2': 'Level 2: Circuit with switch control',
                'post-demo-list-item-3': 'Level 3: Motor circuit challenge',
                'post-demo-list-item-4': 'Level 4: Complete circuit with all components',
                'start-real-game': 'Start Real Game',
                'repeat-demo': 'Repeat Demo',
                'scoreboard-title': 'Game Completed!',
                'scoreboard-message': 'Congratulations! You\'ve completed all levels.',
                'scoreboard-total-label': 'Total Score',
                'scoreboard-levels-label': 'Levels Completed',
                'scoreboard-time-label': 'Total Time',
                'scoreboard-perfect-label': 'Perfect Circuits',
                'play-again': 'Play Again',
                'main-menu': 'Main Menu',
                'hint-title': 'Circuit Hint',
                'connection-text': 'Click another terminal to connect',
                'test-btn-text': 'Test Circuit',
                'clear-btn-text': 'Clear Board',
                'hint-btn-text': 'Get Hint',
                'got-it-btn': 'Got it!'
            },
            or: {
                'demo-step-1-title': '‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡¨ø‡¨≤‡¨°‡¨∞‡¨ï‡≠Å ‡¨∏‡≠ç‡≠±‡¨æ‡¨ó‡¨§!',
                'demo-step-1-text': '‡¨ö‡¨æ‡¨≤‡¨®‡≠ç‡¨§‡≠Å ‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡¨Ö‡¨®‡≠Å‡¨∏‡¨æ‡¨∞‡≠á ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ï‡¨ø‡¨™‡¨∞‡¨ø ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡≠á ‡¨∂‡¨ø‡¨ñ‡¨ø‡¨¨‡¨æ‡•§ ‡¨π‡¨æ‡¨á‡¨≤‡¨æ‡¨á‡¨ü‡≠ç ‡¨π‡≠ã‡¨á‡¨•‡¨ø‡¨¨‡¨æ ‡¨â‡¨™‡¨æ‡¨¶‡¨æ‡¨®‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨Ö‡¨®‡≠Å‡¨∏‡¨∞‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-1-desc': '‡¨è‡¨π‡¨ø ‡¨°‡≠á‡¨Æ‡≠ã‡¨∞‡≠á, ‡¨Ü‡¨Æ‡≠á ‡¨è‡¨ï ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨è‡¨¨‡¨Ç ‡¨è‡¨ï ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨∏‡¨π‡¨ø‡¨§ ‡¨è‡¨ï ‡¨∏‡¨∞‡¨≥ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ‡•§',
                'demo-step-2-title': '‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡≠ß: ‡¨è‡¨ï ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨Ø‡≠ã‡¨°‡¨®‡≠ç‡¨§‡≠Å',
                'demo-step-2-text': '‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á, ‡¨ï‡¨Æ‡≠ç‡¨™‡≠ã‡¨®‡≠á‡¨£‡≠ç‡¨ü ‡¨≤‡¨æ‡¨á‡¨¨‡≠ç‡¨∞‡≠á‡¨∞‡≠Ä‡¨∞‡≠Å <strong>‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä</strong>‡¨ï‡≠Å ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡≠ã‡¨∞‡≠ç‡¨°‡¨ï‡≠Å ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-2-desc': '‡¨¨‡¨æ‡¨Æ ‡¨™‡¨æ‡¨∞‡≠ç‡¨∂‡≠ç‡≠±‡¨∞‡≠á ‡¨•‡¨ø‡¨¨‡¨æ ‡¨≤‡¨æ‡¨á‡¨¨‡≠ç‡¨∞‡≠á‡¨∞‡≠Ä‡¨∞‡≠á ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨ò‡¨ü‡¨ï‡¨ü‡¨ø ‡¨ñ‡≠ã‡¨ú‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-3-title': '‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡≠®: ‡¨è‡¨ï ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨Ø‡≠ã‡¨°‡¨®‡≠ç‡¨§‡≠Å',
                'demo-step-3-text': '‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨Æ‡¨æ‡¨® <strong>‡¨¨‡¨≤‡≠ç‡¨¨</strong>‡¨ï‡≠Å ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡≠ã‡¨∞‡≠ç‡¨°‡¨ï‡≠Å ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å, ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨™‡¨æ‡¨ñ‡¨∞‡≠á‡•§',
                'demo-step-3-desc': '‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨≠‡¨æ‡¨¨‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨π‡≠á‡¨≤‡≠á ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨ú‡¨≥‡¨ø‡¨¨‡•§',
                'demo-step-4-title': '‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡≠©: ‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'demo-step-4-text': '‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä‡¨∞ <strong style="color: #e53e3e;">‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç (‡¨≤‡¨æ‡¨≤‡≠ç +)</strong> ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-4-desc': '‡¨§‡¨æ\'‡¨™‡¨∞‡≠á ‡¨¨‡¨≤‡≠ç‡¨¨‡¨∞ <strong style="color: #e53e3e;">‡¨™‡¨ú‡¨ø‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç (‡¨≤‡¨æ‡¨≤‡≠ç +)</strong> ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨è‡¨ï ‡¨§‡¨æ‡¨∞ ‡¨∏‡≠É‡¨∑‡≠ç‡¨ü‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-5-title': '‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡≠™: ‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'demo-step-5-text': '‡¨™‡≠ç‡¨∞‡¨•‡¨Æ‡≠á ‡¨¨‡¨≤‡≠ç‡¨¨‡¨∞ <strong style="color: #4299e1;">‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç (‡¨®‡≠Ä‡¨≥ -)</strong> ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-5-desc': '‡¨§‡¨æ\'‡¨™‡¨∞‡≠á ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä‡¨∞ <strong style="color: #4299e1;">‡¨®‡≠á‡¨ó‡≠á‡¨ü‡¨ø‡¨≠‡≠ç ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç (‡¨®‡≠Ä‡¨≥ -)</strong> ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-6-title': '‡¨™‡¨¶‡¨ï‡≠ç‡¨∑‡≠á‡¨™ ‡≠´: ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨™‡¨∞‡≠Ä‡¨ï‡≠ç‡¨∑‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'demo-step-6-text': '‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§‡≠ç ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π‡¨ø‡¨§ ‡¨π‡≠á‡¨â‡¨õ‡¨ø ‡¨ï‡¨ø ‡¨®‡¨æ‡¨π‡¨ø‡¨Å ‡¨¶‡≠á‡¨ñ‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å <strong style="color: #38b2ac;">"‡¨ü‡≠á‡¨∑‡≠ç‡¨ü ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç"</strong> ‡¨¨‡¨ü‡¨®‡≠ç ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å‡•§',
                'demo-step-6-desc': '‡¨Ø‡¨¶‡¨ø ‡¨∏‡¨¨‡≠Å‡¨ï‡¨ø‡¨õ‡¨ø ‡¨∏‡¨†‡¨ø‡¨ï‡≠ç ‡¨≠‡¨æ‡¨¨‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨π‡≠ã‡¨á‡¨õ‡¨ø, ‡¨§‡≠á‡¨¨‡≠á ‡¨Ü‡¨™‡¨£ ‡¨ï‡¨∞‡≠á‡¨£‡≠ç‡¨ü ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π‡¨ø‡¨§ ‡¨π‡≠á‡¨â‡¨•‡¨ø‡¨¨‡¨æ ‡¨¶‡≠á‡¨ñ‡¨ø‡¨¨‡≠á ‡¨è‡¨¨‡¨Ç ‡¨¨‡¨≤‡≠ç‡¨¨ ‡¨ú‡¨≥‡¨ø‡¨¨!',
                'skip-demo': '‡¨°‡≠á‡¨Æ‡≠ã ‡¨õ‡¨æ‡¨°‡¨®‡≠ç‡¨§‡≠Å',
                'back': '‡¨™‡¨ø‡¨õ‡¨æ',
                'next': '‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä',
                'got-it': '‡¨¨‡≠Å‡¨ù‡¨ø‡¨ó‡¨≤‡¨ø!',
                'lets-start': '‡¨ö‡¨æ‡¨≤‡¨®‡≠ç‡¨§‡≠Å ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ!',
                'complete-demo': '‡¨™‡≠ç‡¨∞‡¨ï‡≠É‡¨§ ‡¨ñ‡≠á‡¨≥ ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!',
                'post-demo-title': '‡¨°‡≠á‡¨Æ‡≠ã ‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§!',
                'post-demo-text': '‡¨¨‡¨π‡≠Å‡¨§ ‡¨¨‡¨¢‡¨ø‡¨Ü! ‡¨Ü‡¨™‡¨£ ‡¨Æ‡≠å‡¨≥‡¨ø‡¨ï ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ï‡¨ø‡¨™‡¨∞‡¨ø ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡≠á ‡¨∂‡¨ø‡¨ñ‡¨ø‡¨õ‡¨®‡≠ç‡¨§‡¨ø‡•§ ‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡¨Æ‡¨æ‡¨® ‡¨Ü‡¨™‡¨£ ‡¨™‡≠ç‡¨∞‡¨ï‡≠É‡¨§ ‡¨ñ‡≠á‡¨≥ ‡¨ö‡≠ç‡≠ü‡¨æ‡¨≤‡≠á‡¨û‡≠ç‡¨ú‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï ‡¨™‡¨æ‡¨á‡¨Å ‡¨™‡≠ç‡¨∞‡¨∏‡≠ç‡¨§‡≠Å‡¨§!',
                'post-demo-next-title': '‡¨Ü‡¨ó‡≠á ‡¨ï\'‡¨£?',
                'post-demo-list-item-1': '‡¨∏‡≠ç‡¨§‡¨∞ ‡≠ß: ‡¨ü‡¨æ‡¨á‡¨Æ‡¨∞‡≠ç ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨∞‡¨≥ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç',
                'post-demo-list-item-2': '‡¨∏‡≠ç‡¨§‡¨∞ ‡≠®: ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç ‡¨®‡¨ø‡≠ü‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨£ ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç',
                'post-demo-list-item-3': '‡¨∏‡≠ç‡¨§‡¨∞ ‡≠©: ‡¨Æ‡≠ã‡¨ü‡¨∞ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ö‡≠ç‡≠ü‡¨æ‡¨≤‡≠á‡¨û‡≠ç‡¨ú‡≠ç',
                'post-demo-list-item-4': '‡¨∏‡≠ç‡¨§‡¨∞ ‡≠™: ‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨ò‡¨ü‡¨ï ‡¨∏‡¨π‡¨ø‡¨§ ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç',
                'start-real-game': '‡¨™‡≠ç‡¨∞‡¨ï‡≠É‡¨§ ‡¨ñ‡≠á‡¨≥ ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'repeat-demo': '‡¨°‡≠á‡¨Æ‡≠ã ‡¨™‡≠Å‡¨®‡¨∞‡¨æ‡¨¨‡≠É‡¨§‡≠ç‡¨§‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'scoreboard-title': '‡¨ñ‡≠á‡¨≥ ‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§!',
                'scoreboard-message': '‡¨Ö‡¨≠‡¨ø‡¨®‡¨®‡≠ç‡¨¶‡¨®! ‡¨Ü‡¨™‡¨£ ‡¨∏‡¨Æ‡¨∏‡≠ç‡¨§ ‡¨∏‡≠ç‡¨§‡¨∞ ‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§ ‡¨ï‡¨∞‡¨ø‡¨õ‡¨®‡≠ç‡¨§‡¨ø‡•§',
                'scoreboard-total-label': '‡¨Æ‡≠ã‡¨ü ‡¨∏‡≠ç‡¨ï‡≠ã‡¨∞',
                'scoreboard-levels-label': '‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§ ‡¨∏‡≠ç‡¨§‡¨∞',
                'scoreboard-time-label': '‡¨Æ‡≠ã‡¨ü ‡¨∏‡¨Æ‡≠ü',
                'scoreboard-perfect-label': '‡¨®‡¨ø‡¨∞‡≠ç‡¨≠‡≠Å‡¨≤ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç',
                'play-again': '‡¨™‡≠Å‡¨®‡¨∞‡≠ç‡¨¨‡¨æ‡¨∞ ‡¨ñ‡≠á‡¨≥‡¨®‡≠ç‡¨§‡≠Å',
                'main-menu': '‡¨Æ‡≠Å‡¨ñ‡≠ç‡≠ü ‡¨Æ‡≠á‡¨®‡≠Å',
                'hint-title': '‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨∏‡≠Ç‡¨ö‡¨®‡¨æ',
                'connection-text': '‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨Ö‡¨®‡≠ç‡≠ü ‡¨è‡¨ï ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'test-btn-text': '‡¨ü‡≠á‡¨∑‡≠ç‡¨ü ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç',
                'clear-btn-text': '‡¨¨‡≠ã‡¨∞‡≠ç‡¨° ‡¨∏‡¨´‡¨æ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                'hint-btn-text': '‡¨∏‡≠Ç‡¨ö‡¨®‡¨æ ‡¨™‡¨æ‡¨Ü‡¨®‡≠ç‡¨§‡≠Å',
                'got-it-btn': '‡¨¨‡≠Å‡¨ù‡¨ø‡¨ó‡¨≤‡¨ø!'
            },
            hi: {
                'demo-step-1-title': '‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§ø‡§≤‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!',
                'demo-step-1-text': '‡§ö‡§≤‡§ø‡§è ‡§ö‡§∞‡§£ ‡§¶‡§∞ ‡§ö‡§∞‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡•à‡§∏‡•á ‡§¨‡§®‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§∏‡•Ä‡§ñ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§π‡§æ‡§á‡§≤‡§æ‡§á‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§§‡§§‡•ç‡§µ‡•ã‡§Ç ‡§ï‡§æ ‡§™‡§æ‡§≤‡§® ‡§ï‡§∞‡•á‡§Ç‡•§',
                'demo-step-1-desc': '‡§á‡§∏ ‡§°‡•á‡§Æ‡•ã ‡§Æ‡•á‡§Ç, ‡§π‡§Æ ‡§è‡§ï ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§î‡§∞ ‡§è‡§ï ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç‡§ó‡•á‡•§',
                'demo-step-2-title': '‡§ö‡§∞‡§£ 1: ‡§è‡§ï ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ú‡•ã‡§°‡§º‡•á‡§Ç',
                'demo-step-2-text': '‡§™‡§π‡§≤‡•á, ‡§ï‡§Ç‡§™‡•ã‡§®‡•á‡§Ç‡§ü ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§∏‡•á <strong>‡§¨‡•à‡§ü‡§∞‡•Ä</strong> ‡§ï‡•ã ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§',
                'demo-step-2-desc': '‡§¨‡§æ‡§à‡§Ç ‡§ì‡§∞ ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ò‡§ü‡§ï ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§',
                'demo-step-3-title': '‡§ö‡§∞‡§£ 2: ‡§è‡§ï ‡§¨‡§≤‡•ç‡§¨ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç',
                'demo-step-3-text': '‡§Ö‡§¨ <strong>‡§¨‡§≤‡•ç‡§¨</strong> ‡§ï‡•ã ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞, ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•á ‡§¨‡§ó‡§≤ ‡§Æ‡•á‡§Ç ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç‡•§',
                'demo-step-3-desc': '‡§¨‡•à‡§ü‡§∞‡•Ä ‡§∏‡•á ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§®‡•á ‡§™‡§∞ ‡§¨‡§≤‡•ç‡§¨ ‡§ú‡§≤‡•á‡§ó‡§æ‡•§',
                'demo-step-4-title': '‡§ö‡§∞‡§£ 3: ‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç',
                'demo-step-4-text': '‡§™‡§π‡§≤‡•á ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•á <strong style="color: #e53e3e;">‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ (‡§≤‡§æ‡§≤ +)</strong> ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§',
                'demo-step-4-desc': '‡§´‡§ø‡§∞ ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•á <strong style="color: #e53e3e;">‡§™‡•â‡§ú‡§ø‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ (‡§≤‡§æ‡§≤ +)</strong> ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§§‡§æ‡§∞ ‡§¨‡§®‡§æ‡§è‡§Ç‡•§',
                'demo-step-5-title': '‡§ö‡§∞‡§£ 4: ‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç',
                'demo-step-5-text': '‡§™‡§π‡§≤‡•á ‡§¨‡§≤‡•ç‡§¨ ‡§ï‡•á <strong style="color: #4299e1;">‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ (‡§®‡•Ä‡§≤‡§æ -)</strong> ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§',
                'demo-step-5-desc': '‡§´‡§ø‡§∞ ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§ï‡•á <strong style="color: #4299e1;">‡§®‡•á‡§ó‡•á‡§ü‡§ø‡§µ ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ (‡§®‡•Ä‡§≤‡§æ -)</strong> ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'demo-step-6-title': '‡§ö‡§∞‡§£ 5: ‡§Ö‡§™‡§®‡•á ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç',
                'demo-step-6-text': '‡§Ø‡§π ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø ‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§¨‡§π ‡§∞‡§π‡•Ä ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç, <strong style="color: #38b2ac;">"‡§ü‡•á‡§∏‡•ç‡§ü ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü"</strong> ‡§¨‡§ü‡§® ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§',
                'demo-step-6-desc': '‡§Ø‡§¶‡§ø ‡§∏‡§¨ ‡§ï‡•Å‡§õ ‡§∏‡§π‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ ‡§ï‡§∞‡§Ç‡§ü ‡§¨‡§π‡§§‡§æ ‡§π‡•Å‡§Ü ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á ‡§î‡§∞ ‡§¨‡§≤‡•ç‡§¨ ‡§ú‡§≤ ‡§ú‡§æ‡§è‡§ó‡§æ!',
                'skip-demo': '‡§°‡•á‡§Æ‡•ã ‡§õ‡•ã‡§°‡§º‡•á‡§Ç',
                'back': '‡§™‡•Ä‡§õ‡•á',
                'next': '‡§Ü‡§ó‡•á',
                'got-it': '‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ!',
                'lets-start': '‡§ö‡§≤‡§ø‡§è ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç!',
                'complete-demo': '‡§Ö‡§∏‡§≤‡•Ä ‡§ñ‡•á‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç!',
                'post-demo-title': '‡§°‡•á‡§Æ‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ!',
                'post-demo-text': '‡§¨‡§π‡•Å‡§§ ‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ! ‡§Ü‡§™‡§®‡•á ‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§®‡§æ ‡§∏‡•Ä‡§ñ ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à‡•§ ‡§Ö‡§¨ ‡§Ü‡§™ ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§ñ‡•á‡§≤ ‡§ö‡•Å‡§®‡•å‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à‡§Ç!',
                'post-demo-next-title': '‡§Ü‡§ó‡•á ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?',
                'post-demo-list-item-1': '‡§∏‡•ç‡§§‡§∞ 1: ‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§∞‡§≤ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü',
                'post-demo-list-item-2': '‡§∏‡•ç‡§§‡§∞ 2: ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü',
                'post-demo-list-item-3': '‡§∏‡•ç‡§§‡§∞ 3: ‡§Æ‡•ã‡§ü‡§∞ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ö‡•Å‡§®‡•å‡§§‡•Ä',
                'post-demo-list-item-4': '‡§∏‡•ç‡§§‡§∞ 4: ‡§∏‡§≠‡•Ä ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü',
                'start-real-game': '‡§Ö‡§∏‡§≤‡•Ä ‡§ñ‡•á‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',
                'repeat-demo': '‡§°‡•á‡§Æ‡•ã ‡§¶‡•ã‡§π‡§∞‡§æ‡§è‡§Ç',
                'scoreboard-title': '‡§ñ‡•á‡§≤ ‡§™‡•Ç‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ!',
                'scoreboard-message': '‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! ‡§Ü‡§™‡§®‡•á ‡§∏‡§≠‡•Ä ‡§∏‡•ç‡§§‡§∞ ‡§™‡•Ç‡§∞‡•á ‡§ï‡§∞ ‡§≤‡§ø‡§è ‡§π‡•à‡§Ç‡•§',
                'scoreboard-total-label': '‡§ï‡•Å‡§≤ ‡§∏‡•ç‡§ï‡•ã‡§∞',
                'scoreboard-levels-label': '‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•ç‡§§‡§∞',
                'scoreboard-time-label': '‡§ï‡•Å‡§≤ ‡§∏‡§Æ‡§Ø',
                'scoreboard-perfect-label': '‡§∏‡§π‡•Ä ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü',
                'play-again': '‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡•á‡§Ç',
                'main-menu': '‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Æ‡•á‡§®‡•Ç',
                'hint-title': '‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§∏‡§Ç‡§ï‡•á‡§§',
                'connection-text': '‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç',
                'test-btn-text': '‡§ü‡•á‡§∏‡•ç‡§ü ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü',
                'clear-btn-text': '‡§¨‡•ã‡§∞‡•ç‡§° ‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç',
                'hint-btn-text': '‡§∏‡§Ç‡§ï‡•á‡§§ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç',
                'got-it-btn': '‡§∏‡§Æ‡§ù ‡§ó‡§Ø‡§æ!'
            }
        };

        // Initialize Game - SHOW INSTRUCTIONS FIRST
        function initGame() {
            loadComponentsLibrary();
            setupEventListeners();
            
            // Show instructions modal first (already visible in CSS)
            instructionsModal.style.display = 'flex';
        }

        // Load Components into Library
        function loadComponentsLibrary() {
            componentsLibrary.innerHTML = '';
            
            circuitComponents.forEach((component) => {
                const item = document.createElement('div');
                item.className = 'library-item';
                item.draggable = true;
                item.dataset.id = component.id;
                item.dataset.type = component.type;
                item.innerHTML = `
                    <div class="library-icon">${component.icon}</div>
                    <div class="library-name">${component.name[currentLanguage]}</div>
                `;
                
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
                
                componentsLibrary.appendChild(item);
            });
        }

        // Setup Event Listeners
        function setupEventListeners() {
            // Game Controls
            document.getElementById('start-game-btn').addEventListener('click', startDemo);
            document.getElementById('test-circuit-btn').addEventListener('click', testCircuit);
            document.getElementById('clear-circuit-btn').addEventListener('click', clearCircuit);
            document.getElementById('hint-btn').addEventListener('click', showHint);
            document.getElementById('cancel-connection').addEventListener('click', cancelConnection);
            
            // Demo Controls
            document.getElementById('skip-demo').addEventListener('click', skipDemo);
            document.getElementById('complete-demo').addEventListener('click', completeDemo);
            
            // Post-Demo Controls
            document.getElementById('start-real-game-btn').addEventListener('click', startRealGame);
            document.getElementById('repeat-demo-btn').addEventListener('click', repeatDemo);
            
            // Scoreboard Controls
            document.getElementById('scoreboard-restart').addEventListener('click', restartGame);
            document.getElementById('scoreboard-menu').addEventListener('click', showInstructions);
            
            // Demo navigation buttons
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`next-demo-${i}`)?.addEventListener('click', () => nextDemoStep(i + 1));
                if (i > 1) {
                    document.getElementById(`back-demo-${i}`)?.addEventListener('click', () => nextDemoStep(i - 1));
                }
            }
            
            // Hint System
            closeHint.addEventListener('click', closeHintHandler);
            popupOverlay.addEventListener('click', closeHintHandler);
            
            // Circuit Board Events
            circuitBoard.addEventListener('dragover', handleDragOver);
            circuitBoard.addEventListener('dragenter', handleDragEnter);
            circuitBoard.addEventListener('dragleave', handleDragLeave);
            circuitBoard.addEventListener('drop', handleDrop);
            
            // Language Switcher
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', () => switchLanguage(btn.dataset.lang));
            });
            
            // Keyboard Support
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    cancelConnection();
                    closeHintHandler();
                }
                if (e.key === 'Delete') deleteSelectedComponent();
                if (e.key === 't' || e.key === 'T') testCircuit();
                if (e.key === 'r' || e.key === 'R') clearCircuit();
                if (e.key === 'h' || e.key === 'H') showHint();
            });
        }

        function closeHintHandler() {
            hintPopup.classList.remove('active');
            popupOverlay.classList.remove('active');
        }

        // Demo Functions
        function nextDemoStep(step) {
            demoStep = step;
            updateDemoStep();
        }

        function updateDemoStep() {
            document.querySelectorAll('.demo-step').forEach(step => {
                step.classList.remove('active');
            });
            
            document.getElementById(`demo-step-${demoStep}`).classList.add('active');
        }

        // Start Demo (from instructions)
        function startDemo() {
            instructionsModal.style.display = 'none';
            
            // Reset game stats
            score = 0;
            streak = 0;
            currentLevel = 0;
            
            // Load demo level
            loadLevel(0);
            updateScore();
            updateStreak();
            
            showToast('Starting Demo Level. Follow the step-by-step guide!', 'info');
        }

        // Skip Demo
        function skipDemo() {
            demoOverlay.style.display = 'none';
            isDemoMode = false;
            demoCompleted = true;
            
            // Show post-demo message
            showPostDemoMessage();
            
            showToast('Demo skipped. Ready for real game?', 'info');
        }

        // Complete Demo
        function completeDemo() {
            demoOverlay.style.display = 'none';
            isDemoMode = false;
            demoCompleted = true;
            
            // Give points for completing demo
            score += 50;
            updateScore();
            
            // Show post-demo message
            showPostDemoMessage();
            
            showToast('Demo completed successfully!', 'success');
        }

        // Show post-demo message
        function showPostDemoMessage() {
            postDemoMessage.classList.add('active');
            gameHeader.style.display = 'none';
            gameStatsContainer.style.display = 'none';
            gameArea.style.display = 'none';
            document.body.style.overflow = 'auto';
            document.body.style.backgroundColor = '#f0f7ff';
        }

        // Start real game after demo
        function startRealGame() {
            postDemoMessage.classList.remove('active');
            isDemoMode = false;
            demoCompleted = true;
            currentLevel = 1;
            gameLevels[1].unlocked = true;
            loadLevel(currentLevel);
            showToast('Starting Level 1! Good luck!', 'success');
        }

        // Repeat demo
        function repeatDemo() {
            postDemoMessage.classList.remove('active');
            demoCompleted = false;
            currentLevel = 0;
            loadLevel(0);
        }

        // Show scoreboard when all levels completed
        function showScoreboard() {
            // Calculate stats
            const totalScore = score;
            const completedLevels = levelsCompleted;
            const perfect = perfectCircuits;
            
            // Update scoreboard
            finalTotalScore.textContent = totalScore;
            finalLevelsCompleted.textContent = `${completedLevels}/4`;
            finalTotalTime.textContent = `${totalTimePlayed}s`;
            finalPerfectCircuits.textContent = perfect;
            
            // Show scoreboard
            scoreboard.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Restart game from scoreboard
        function restartGame() {
            scoreboard.classList.remove('active');
            
            // Reset game stats
            score = 0;
            streak = 0;
            perfectCircuits = 0;
            totalTimePlayed = 0;
            levelsCompleted = 0;
            
            // Reset all levels except demo
            gameLevels.forEach(level => {
                if (level.id !== 0) {
                    level.unlocked = level.id === 1;
                }
            });
            
            // Start from level 1
            currentLevel = 1;
            loadLevel(currentLevel);
            updateScore();
            updateStreak();
            
            showToast('Game restarted!', 'info');
        }

        // Drag and Drop Functions
        function handleDragStart(e) {
            this.classList.add('dragging');
            e.dataTransfer.setData('text/plain', this.dataset.id);
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            circuitBoard.style.borderColor = '#4299e1';
        }

        function handleDragEnter(e) {
            e.preventDefault();
        }

        function handleDragLeave() {
            circuitBoard.style.borderColor = '#cbd5e0';
        }

        function handleDrop(e) {
            e.preventDefault();
            circuitBoard.style.borderColor = '#cbd5e0';
            
            const componentId = parseInt(e.dataTransfer.getData('text/plain'));
            const componentData = circuitComponents.find(c => c.id === componentId);
            
            if (!componentData) return;
            
            const rect = circuitBoard.getBoundingClientRect();
            let x = e.clientX - rect.left - 50;
            let y = e.clientY - rect.top - 50;
            
            placeComponent(componentData, x, y);
        }

        // Place Component on Board
        function placeComponent(componentData, x, y) {
            const componentId = Date.now();
            const component = {
                id: componentId,
                data: componentData,
                x: Math.max(20, Math.min(x, 800)),
                y: Math.max(20, Math.min(y, 300)),
                connections: [],
                powered: false
            };
            
            placedComponents.push(component);
            
            // Create Component Element
            const element = document.createElement('div');
            element.className = 'circuit-component placed';
            element.dataset.componentId = componentId;
            element.style.left = `${component.x}px`;
            element.style.top = `${component.y}px`;
            
            element.innerHTML = `
                <div class="component-icon">${componentData.icon}</div>
                <div class="component-label">${componentData.name[currentLanguage]}</div>
            `;
            
            // Add Terminals
            componentData.terminals.forEach(terminal => {
                const terminalEl = document.createElement('div');
                terminalEl.className = `terminal ${terminal.type}`;
                terminalEl.dataset.componentId = componentId;
                terminalEl.dataset.terminalId = terminal.id;
                terminalEl.dataset.type = terminal.type;
                terminalEl.title = `${terminal.label} (${terminal.type})`;
                
                terminalEl.style.left = `${terminal.x - 10}px`;
                terminalEl.style.top = `${terminal.y - 10}px`;
                terminalEl.textContent = terminal.label;
                
                terminalEl.addEventListener('click', (e) => handleTerminalClick(e, terminalEl));
                element.appendChild(terminalEl);
            });
            
            // Make Draggable
            makeDraggable(element, component);
            
            circuitBoard.appendChild(element);
            
            showToast(`Added ${componentData.name[currentLanguage]}`, 'success');
            updateRequirements();
            updateCircuitStatus();
        }

        // Make Component Draggable
        function makeDraggable(element, component) {
            let isDragging = false;
            let startX, startY;
            
            element.addEventListener('mousedown', startDrag);
            
            function startDrag(e) {
                if (e.target.classList.contains('terminal')) return;
                
                isDragging = true;
                element.classList.add('dragging');
                
                startX = e.clientX;
                startY = e.clientY;
                
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', stopDrag);
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                
                component.x += dx;
                component.y += dy;
                
                component.x = Math.max(20, Math.min(component.x, 800));
                component.y = Math.max(20, Math.min(component.y, 300));
                
                element.style.left = `${component.x}px`;
                element.style.top = `${component.y}px`;
                
                startX = e.clientX;
                startY = e.clientY;
                
                updateWires(component);
            }
            
            function stopDrag() {
                isDragging = false;
                element.classList.remove('dragging');
                
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
                
                snapToGrid(component, element);
            }
        }

        // Snap to Grid
        function snapToGrid(component, element) {
            const gridSize = 40;
            component.x = Math.round(component.x / gridSize) * gridSize;
            component.y = Math.round(component.y / gridSize) * gridSize;
            
            element.style.left = `${component.x}px`;
            element.style.top = `${component.y}px`;
            
            updateWires(component);
        }

        // Handle Terminal Click
        function handleTerminalClick(e, terminalEl) {
            e.stopPropagation();
            
            const componentId = parseInt(terminalEl.dataset.componentId);
            const terminalId = terminalEl.dataset.terminalId;
            const terminalType = terminalEl.dataset.type;
            
            if (!selectedTerminal) {
                selectedTerminal = { componentId, terminalId, terminalType, element: terminalEl };
                terminalEl.classList.add('selected');
                connectionInstruction.classList.add('show');
                showWireHelper(terminalEl);
                showToast('Click another terminal to connect', 'info');
            } else {
                if (selectedTerminal.componentId === componentId && selectedTerminal.terminalId === terminalId) {
                    cancelConnection();
                    return;
                }
                
                createWire(selectedTerminal, { componentId, terminalId, terminalType, element: terminalEl });
                cancelConnection();
            }
        }

        // Show Wire Helper
        function showWireHelper(terminalEl) {
            const rect = terminalEl.getBoundingClientRect();
            const boardRect = circuitBoard.getBoundingClientRect();
            
            wireHelper.style.left = `${rect.left - boardRect.left + 10}px`;
            wireHelper.style.top = `${rect.top - boardRect.top + 10}px`;
            wireHelper.classList.add('visible');
            
            function updateHelper(e) {
                const x = e.clientX - boardRect.left;
                const y = e.clientY - boardRect.top;
                
                const dx = x - (rect.left - boardRect.left + 10);
                const dy = y - (rect.top - boardRect.top + 10);
                const length = Math.sqrt(dx * dx + dy * dy);
                const angle = Math.atan2(dy, dx) * (180 / Math.PI);
                
                wireHelper.style.width = `${length}px`;
                wireHelper.style.transform = `rotate(${angle}deg)`;
            }
            
            document.addEventListener('mousemove', updateHelper);
            wireHelper.updateFunction = updateHelper;
        }

        // Create Wire Connection
        function createWire(terminal1, terminal2) {
            const existingWire = wires.find(w => 
                (w.from.componentId === terminal1.componentId && w.from.terminalId === terminal1.terminalId &&
                 w.to.componentId === terminal2.componentId && w.to.terminalId === terminal2.terminalId) ||
                (w.from.componentId === terminal2.componentId && w.from.terminalId === terminal2.terminalId &&
                 w.to.componentId === terminal1.componentId && w.to.terminalId === terminal1.terminalId)
            );
            
            if (existingWire) {
                showToast('Already connected!', 'error');
                return;
            }
            
            const comp1 = placedComponents.find(c => c.id === terminal1.componentId);
            const comp2 = placedComponents.find(c => c.id === terminal2.componentId);
            
            if (!comp1 || !comp2) return;
            
            const pos1 = getTerminalPosition(comp1, terminal1.terminalId);
            const pos2 = getTerminalPosition(comp2, terminal2.terminalId);
            
            const wireElement = document.createElement('div');
            wireElement.className = 'wire connected';
            
            const dx = pos2.x - pos1.x;
            const dy = pos2.y - pos1.y;
            const length = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * (180 / Math.PI);
            
            wireElement.style.width = `${length}px`;
            wireElement.style.left = `${pos1.x}px`;
            wireElement.style.top = `${pos1.y}px`;
            wireElement.style.transform = `rotate(${angle}deg)`;
            
            circuitBoard.appendChild(wireElement);
            
            const wireId = Date.now();
            const wire = {
                id: wireId,
                element: wireElement,
                from: {
                    componentId: terminal1.componentId,
                    terminalId: terminal1.terminalId,
                    type: terminal1.terminalType
                },
                to: {
                    componentId: terminal2.componentId,
                    terminalId: terminal2.terminalId,
                    type: terminal2.terminalType
                },
                powered: false
            };
            
            wires.push(wire);
            
            comp1.connections.push({
                terminalId: terminal1.terminalId,
                connectedTo: {
                    componentId: terminal2.componentId,
                    terminalId: terminal2.terminalId
                },
                wireId: wireId
            });
            
            comp2.connections.push({
                terminalId: terminal2.terminalId,
                connectedTo: {
                    componentId: terminal1.componentId,
                    terminalId: terminal1.terminalId
                },
                wireId: wireId
            });
            
            terminal1.element.classList.remove('selected');
            terminal1.element.classList.add('connected');
            terminal2.element.classList.add('connected');
            
            showToast('Wire connected successfully!', 'success');
            streak++;
            updateStreak();
            updateCircuitStatus();
        }

        // Get Terminal Position
        function getTerminalPosition(component, terminalId) {
            const terminal = component.data.terminals.find(t => t.id === terminalId);
            if (!terminal) return { x: component.x + 50, y: component.y + 50 };
            
            return {
                x: component.x + terminal.x,
                y: component.y + terminal.y
            };
        }

        // Update Wires when Component Moves
        function updateWires(component) {
            component.connections.forEach(conn => {
                const wire = wires.find(w => w.id === conn.wireId);
                if (!wire) return;
                
                const isFrom = wire.from.componentId === component.id;
                const termId = isFrom ? wire.from.terminalId : wire.to.terminalId;
                const termPos = getTerminalPosition(component, termId);
                
                if (isFrom) {
                    const toComp = placedComponents.find(c => c.id === wire.to.componentId);
                    const toPos = getTerminalPosition(toComp, wire.to.terminalId);
                    
                    const dx = toPos.x - termPos.x;
                    const dy = toPos.y - termPos.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * (180 / Math.PI);
                    
                    wire.element.style.width = `${length}px`;
                    wire.element.style.left = `${termPos.x}px`;
                    wire.element.style.top = `${termPos.y}px`;
                    wire.element.style.transform = `rotate(${angle}deg)`;
                } else {
                    const fromComp = placedComponents.find(c => c.id === wire.from.componentId);
                    const fromPos = getTerminalPosition(fromComp, wire.from.terminalId);
                    
                    const dx = termPos.x - fromPos.x;
                    const dy = termPos.y - fromPos.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * (180 / Math.PI);
                    
                    wire.element.style.width = `${length}px`;
                    wire.element.style.transform = `rotate(${angle}deg)`;
                }
            });
        }

        // Cancel Connection
        function cancelConnection() {
            if (selectedTerminal) {
                selectedTerminal.element.classList.remove('selected');
                selectedTerminal = null;
            }
            connectionInstruction.classList.remove('show');
            wireHelper.classList.remove('visible');
            
            if (wireHelper.updateFunction) {
                document.removeEventListener('mousemove', wireHelper.updateFunction);
                wireHelper.updateFunction = null;
            }
        }

        // Test Circuit
        function testCircuit() {
            if (isTesting) {
                stopCurrentFlow();
                return;
            }
            
            const analysis = analyzeCircuit();
            
            if (analysis.isComplete) {
                startCurrentFlow(analysis);
                
                circuitStatusElement.className = 'status-indicator on';
                circuitStatusElement.innerHTML = '<i class="fas fa-check-circle"></i> Circuit Working';
                currentMeter.style.width = '100%';
                voltageReading.textContent = '9V';
                currentReading.textContent = `${Math.round(analysis.current)}mA`;
                statusReading.textContent = 'Closed';
                
                score += analysis.points;
                updateScore();
                
                if (analysis.perfect) {
                    perfectCircuits++;
                }
                
                if (checkLevelCompletion()) {
                    setTimeout(() => {
                        completeLevel(analysis);
                    }, 1500);
                }
                
                showToast(analysis.message, 'success');
            } else {
                showShortCircuit();
                
                circuitStatusElement.className = 'status-indicator off';
                circuitStatusElement.innerHTML = '<i class="fas fa-times-circle"></i> Circuit Error';
                currentMeter.style.width = '30%';
                voltageReading.textContent = '0V';
                currentReading.textContent = '0mA';
                statusReading.textContent = analysis.error;
                
                streak = 0;
                updateStreak();
                
                showToast(analysis.message, 'error');
            }
        }

        // Analyze Circuit
        function analyzeCircuit() {
            const battery = placedComponents.find(c => c.data.type === 'power');
            if (!battery) {
                return {
                    isComplete: false,
                    error: 'No Power',
                    message: 'Add a battery to provide power!'
                };
            }

            const loads = placedComponents.filter(c => c.data.type === 'load');
            if (loads.length === 0) {
                return {
                    isComplete: false,
                    error: 'No Load',
                    message: 'Add a bulb or motor to use the electricity!'
                };
            }

            const positiveConnected = battery.connections.some(conn => 
                conn.terminalId === 'positive'
            );
            const negativeConnected = battery.connections.some(conn => 
                conn.terminalId === 'negative'
            );

            if (!positiveConnected || !negativeConnected) {
                return {
                    isComplete: false,
                    error: 'Battery Not Fully Connected',
                    message: 'Connect both battery terminals! Positive (+) and Negative (-)'
                };
            }

            let connectedLoads = 0;
            let perfect = true;
            
            for (let load of loads) {
                if (isLoadInCompleteCircuit(load, battery)) {
                    connectedLoads++;
                } else {
                    perfect = false;
                }
            }

            if (connectedLoads === 0) {
                return {
                    isComplete: false,
                    error: 'No Complete Circuit',
                    message: 'Loads must be connected in a complete loop back to the battery!'
                };
            }

            const current = (9 / (100 * connectedLoads)) * 1000;

            return {
                isComplete: true,
                current: current,
                points: isDemoMode ? 50 : 100 + (streak * 10) + (connectedLoads * 20),
                perfect: perfect && connectedLoads === loads.length,
                message: `Perfect! ${connectedLoads} load${connectedLoads > 1 ? 's' : ''} working. Current: ${Math.round(current)}mA`
            };
        }

        // Check if load is in complete circuit
        function isLoadInCompleteCircuit(load, battery) {
            const hasPositiveWire = load.connections.some(conn => 
                conn.terminalId === 'positive'
            );
            const hasNegativeWire = load.connections.some(conn => 
                conn.terminalId === 'negative'
            );
            return hasPositiveWire && hasNegativeWire;
        }

        // Start Current Flow Animation
        function startCurrentFlow(analysis) {
            isTesting = true;
            document.getElementById('test-circuit-btn').innerHTML = '<i class="fas fa-stop"></i> Stop Test';
            
            wires.forEach(wire => {
                wire.element.classList.add('powered');
                wire.powered = true;
                createCurrentParticles(wire);
            });
            
            placedComponents.forEach(comp => {
                if (comp.data.type === 'load') {
                    comp.powered = true;
                    const compEl = document.querySelector(`[data-component-id="${comp.id}"]`);
                    if (compEl) {
                        compEl.classList.add('powered');
                        if (comp.data.icon === 'üîÑ') {
                            compEl.querySelector('.component-icon').style.animation = 'spin 2s linear infinite';
                        }
                    }
                }
            });
            
            currentFlowInterval = setInterval(() => {
                wires.forEach(wire => {
                    if (wire.powered) {
                        createCurrentParticles(wire);
                    }
                });
            }, 500);
        }

        // Create Current Particles
        function createCurrentParticles(wire) {
            const wireEl = wire.element;
            const rect = wireEl.getBoundingClientRect();
            const boardRect = circuitBoard.getBoundingClientRect();
            
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'current-particle';
                    
                    const progress = Math.random();
                    const x = rect.left - boardRect.left + rect.width * progress;
                    const y = rect.top - boardRect.top;
                    
                    particle.style.left = `${x}px`;
                    particle.style.top = `${y}px`;
                    
                    circuitBoard.appendChild(particle);
                    
                    const speed = 2 + Math.random() * 2;
                    let pos = 0;
                    
                    function animate() {
                        pos += speed;
                        particle.style.left = `${x + pos}px`;
                        particle.style.opacity = 1 - (pos / rect.width);
                        
                        if (pos < rect.width) {
                            requestAnimationFrame(animate);
                        } else {
                            particle.remove();
                        }
                    }
                    
                    animate();
                }, i * 200);
            }
        }

        // Stop Current Flow
        function stopCurrentFlow() {
            isTesting = false;
            document.getElementById('test-circuit-btn').innerHTML = '<i class="fas fa-play"></i> Test Circuit';
            
            if (currentFlowInterval) {
                clearInterval(currentFlowInterval);
                currentFlowInterval = null;
            }
            
            wires.forEach(wire => {
                wire.element.classList.remove('powered');
                wire.powered = false;
            });
            
            placedComponents.forEach(comp => {
                comp.powered = false;
                const compEl = document.querySelector(`[data-component-id="${comp.id}"]`);
                if (compEl) {
                    compEl.classList.remove('powered');
                    compEl.querySelector('.component-icon').style.animation = '';
                }
            });
            
            document.querySelectorAll('.current-particle').forEach(p => p.remove());
        }

        // Show Short Circuit Effect
        function showShortCircuit() {
            placedComponents.forEach(comp => {
                const compEl = document.querySelector(`[data-component-id="${comp.id}"]`);
                if (compEl) {
                    compEl.classList.add('short-circuit');
                    setTimeout(() => compEl.classList.remove('short-circuit'), 500);
                }
            });
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const spark = document.createElement('div');
                    spark.style.position = 'absolute';
                    spark.style.left = `${Math.random() * circuitBoard.clientWidth}px`;
                    spark.style.top = `${Math.random() * circuitBoard.clientHeight}px`;
                    spark.style.width = '12px';
                    spark.style.height = '12px';
                    spark.style.background = 'radial-gradient(circle, #e53e3e, transparent)';
                    spark.style.borderRadius = '50%';
                    spark.style.boxShadow = '0 0 15px #e53e3e';
                    
                    circuitBoard.appendChild(spark);
                    setTimeout(() => spark.remove(), 300);
                }, i * 100);
            }
        }

        // Update Circuit Status
        function updateCircuitStatus() {
            const battery = placedComponents.find(c => c.data.type === 'power');
            const loads = placedComponents.filter(c => c.data.type === 'load');
            const wireCount = wires.length;
            
            if (!battery) {
                circuitStatusElement.className = 'status-indicator off';
                circuitStatusElement.innerHTML = '<i class="fas fa-times-circle"></i> No Power';
            } else if (loads.length === 0) {
                circuitStatusElement.className = 'status-indicator off';
                circuitStatusElement.innerHTML = '<i class="fas fa-times-circle"></i> No Load';
            } else if (wireCount < 2) {
                circuitStatusElement.className = 'status-indicator off';
                circuitStatusElement.innerHTML = '<i class="fas fa-times-circle"></i> Need Connections';
            } else {
                circuitStatusElement.className = 'status-indicator';
                circuitStatusElement.innerHTML = '<i class="fas fa-check-circle"></i> Ready to Test';
            }
        }

        // Update Requirements Display
        function updateRequirements() {
            if (currentLevel < 0 || currentLevel >= gameLevels.length) return;
            
            const level = gameLevels[currentLevel];
            requirementsGrid.innerHTML = '';
            
            level.requirements.forEach(req => {
                const count = placedComponents.filter(c => c.data.type === req.type).length;
                const completed = count >= req.count;
                
                const item = document.createElement('div');
                item.className = `requirement-item ${completed ? 'completed' : ''}`;
                
                const icon = document.createElement('div');
                icon.className = 'requirement-icon';
                icon.textContent = getComponentIcon(req.type);
                
                const text = document.createElement('div');
                text.className = 'requirement-text';
                
                const name = document.createElement('div');
                name.className = 'requirement-name';
                name.textContent = req.name;
                
                const countEl = document.createElement('div');
                countEl.className = 'requirement-count';
                countEl.textContent = `${count}/${req.count}`;
                
                text.appendChild(name);
                text.appendChild(countEl);
                
                const check = document.createElement('div');
                check.className = 'requirement-check';
                check.innerHTML = completed ? '‚úì' : '';
                
                item.appendChild(icon);
                item.appendChild(text);
                item.appendChild(check);
                
                requirementsGrid.appendChild(item);
            });
            
            const totalRequired = level.requirements.reduce((sum, req) => sum + req.count, 0);
            const totalPlaced = placedComponents.filter(c => 
                level.requirements.some(req => req.type === c.data.type)
            ).length;
            const progress = Math.min(100, (totalPlaced / totalRequired) * 100);
            progressElement.style.width = `${progress}%`;
        }

        function getComponentIcon(type) {
            const component = circuitComponents.find(c => c.type === type);
            return component ? component.icon : '‚öõÔ∏è';
        }

        // Check Level Completion
        function checkLevelCompletion() {
            if (currentLevel < 0 || currentLevel >= gameLevels.length) return false;
            if (levelCompleted) return false;
            
            const level = gameLevels[currentLevel];
            const allRequirementsMet = level.requirements.every(req => {
                const count = placedComponents.filter(c => c.data.type === req.type).length;
                return count >= req.count;
            });
            
            const battery = placedComponents.find(c => c.data.type === 'power');
            const loads = placedComponents.filter(c => c.data.type === 'load');
            const hasConnections = wires.length >= 2;
            
            return allRequirementsMet && battery && loads.length > 0 && hasConnections;
        }

        // Complete Level
        function completeLevel(analysis) {
            levelCompleted = true;
            stopCurrentFlow();
            
            const timeTaken = Math.floor((Date.now() - levelStartTime) / 1000);
            totalTimePlayed += timeTaken;
            const timeBonus = isDemoMode ? 0 : Math.max(0, 100 - timeTaken);
            const totalScore = analysis.points + timeBonus;
            
            score += totalScore;
            levelsCompleted++;
            updateScore();
            
            document.getElementById('final-score').textContent = `+${totalScore}`;
            document.getElementById('final-time').textContent = `${timeTaken}s`;
            document.getElementById('final-streak').textContent = streak;
            
            // Clear previous buttons
            levelCompleteButtons.innerHTML = '';
            
            if (isDemoMode) {
                document.getElementById('complete-title').textContent = 'Demo Complete!';
                document.getElementById('level-complete-text').textContent = 
                    'Great job! You\'ve built your first circuit. Now you\'re ready for Level 1!';
                
                const nextBtn = document.createElement('button');
                nextBtn.className = 'next-level-btn';
                nextBtn.innerHTML = '<i class="fas fa-forward"></i> Start Level 1';
                nextBtn.addEventListener('click', () => {
                    document.getElementById('level-complete').style.display = 'none';
                    showPostDemoMessage();
                });
                levelCompleteButtons.appendChild(nextBtn);
                
                document.getElementById('level-complete').style.display = 'block';
            } else if (currentLevel === 4) {
                // After Level 4, show View Scores button
                document.getElementById('complete-title').textContent = 'All Levels Complete!';
                document.getElementById('level-complete-text').textContent = 
                    'Congratulations! You\'ve completed all levels. View your final scores.';
                
                const viewScoresBtn = document.createElement('button');
                viewScoresBtn.className = 'view-scores-btn';
                viewScoresBtn.innerHTML = '<i class="fas fa-chart-bar"></i> View Scores';
                viewScoresBtn.addEventListener('click', () => {
                    document.getElementById('level-complete').style.display = 'none';
                    showScoreboard();
                });
                levelCompleteButtons.appendChild(viewScoresBtn);
                
                const playAgainBtn = document.createElement('button');
                playAgainBtn.className = 'next-level-btn';
                playAgainBtn.innerHTML = '<i class="fas fa-redo"></i> Play Again';
                playAgainBtn.addEventListener('click', playAgain);
                levelCompleteButtons.appendChild(playAgainBtn);
                
                document.getElementById('level-complete').style.display = 'block';
            } else {
                document.getElementById('complete-title').textContent = `Level ${currentLevel} Complete!`;
                document.getElementById('level-complete-text').textContent = 
                    `Perfect circuit! ${analysis.message}`;
                
                const nextBtn = document.createElement('button');
                nextBtn.className = 'next-level-btn';
                nextBtn.innerHTML = '<i class="fas fa-forward"></i> Next Level';
                nextBtn.addEventListener('click', nextLevel);
                levelCompleteButtons.appendChild(nextBtn);
                
                const playAgainBtn = document.createElement('button');
                playAgainBtn.className = 'view-scores-btn';
                playAgainBtn.innerHTML = '<i class="fas fa-redo"></i> Play Again';
                playAgainBtn.addEventListener('click', playAgain);
                levelCompleteButtons.appendChild(playAgainBtn);
                
                document.getElementById('level-complete').style.display = 'block';
                
                if (currentLevel + 1 < gameLevels.length) {
                    gameLevels[currentLevel + 1].unlocked = true;
                }
            }
            
            createConfetti();
        }

        // Clear Circuit
        function clearCircuit() {
            placedComponents = [];
            wires = [];
            selectedTerminal = null;
            stopCurrentFlow();
            cancelConnection();
            levelCompleted = false;
            
            circuitBoard.innerHTML = '';
            
            updateCircuitStatus();
            updateRequirements();
            streak = 0;
            updateStreak();
            
            showToast('Circuit board cleared', 'info');
        }

        // Show Hint
        function showHint() {
            if (hintPopup.classList.contains('active')) {
                closeHintHandler();
                return;
            }
            
            if (currentLevel < 0 || currentLevel >= gameLevels.length) return;
            
            const level = gameLevels[currentLevel];
            const missingRequirements = level.requirements.filter(req => {
                const count = placedComponents.filter(c => c.data.type === req.type).length;
                return count < req.count;
            });
            
            let hintHTML = '';
            
            if (missingRequirements.length > 0) {
                const req = missingRequirements[0];
                const needed = req.count - placedComponents.filter(c => c.data.type === req.type).length;
                hintHTML = `
                    <p>You need to add <strong>${needed} more ${req.name}</strong> to complete this level.</p>
                    <div class="hint-diagram">
                        <div style="font-size: 3rem;">${getComponentIcon(req.type)}</div>
                        <p style="margin-top: 10px;">Drag ${needed} ${req.name}${needed > 1 ? 's' : ''} from the library</p>
                    </div>
                    <p>The ${req.name.toLowerCase()} ${req.type === 'power' ? 'provides electrical energy to the circuit' : 
                        req.type === 'load' ? 'uses the electricity (lights up or spins)' : 
                        'controls the flow of electricity'}.</p>
                `;
            } else if (wires.length < 2) {
                hintHTML = `
                    <p>You have all components but need to <strong>connect them with wires</strong>.</p>
                    <div class="hint-diagram">
                        <div style="display: flex; justify-content: center; gap: 20px; align-items: center;">
                            <div style="font-size: 2rem;">üîã</div>
                            <div style="color: #d69e2e; font-size: 1.5rem;">‚Üí</div>
                            <div style="font-size: 2rem;">üí°</div>
                            <div style="color: #d69e2e; font-size: 1.5rem;">‚Üí</div>
                            <div style="font-size: 2rem;">üîã</div>
                        </div>
                        <p style="margin-top: 10px;">Connect battery (+) to load (+), load (-) to battery (-)</p>
                    </div>
                    <p><strong>Click terminals to create wires:</strong> Red (+) to Red (+), Blue (-) to Blue (-)</p>
                `;
            } else {
                if (level.id === 2) {
                    hintHTML = `
                        <p><strong>How to Connect a Switch:</strong></p>
                        <div class="hint-diagram">
                            <div style="display: flex; justify-content: center; gap: 10px; align-items: center;">
                                <div style="text-align: center;">
                                    <div style="font-size: 2rem;">üîã</div>
                                    <div style="font-size: 0.8rem; color: #e53e3e;">+</div>
                                </div>
                                <div style="color: #d69e2e; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2rem;">‚ö°</div>
                                    <div style="font-size: 0.8rem;">IN</div>
                                </div>
                                <div style="color: #d69e2e; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2rem;">‚ö°</div>
                                    <div style="font-size: 0.8rem;">OUT</div>
                                </div>
                                <div style="color: #d69e2e; font-size: 1.5rem;">‚Üí</div>
                                <div style="text-align: center;">
                                    <div style="font-size: 2rem;">üí°</div>
                                    <div style="font-size: 0.8rem; color: #e53e3e;">+</div>
                                </div>
                            </div>
                            <p style="margin-top: 10px;">Place switch between battery and bulb</p>
                        </div>
                        <p><strong>Connection order:</strong><br>
                        1. Battery (+) ‚Üí Switch IN<br>
                        2. Switch OUT ‚Üí Bulb (+)<br>
                        3. Bulb (-) ‚Üí Battery (-)</p>
                        <p>Switches control the flow - they have no polarity (IN/OUT can connect either way).</p>
                    `;
                } else if (level.id === 4) {
                    hintHTML = `
                        <p><strong>Complete Circuit with Multiple Loads:</strong></p>
                        <div class="hint-diagram">
                            <div style="font-size: 3rem; margin-bottom: 10px;">üîã ‚ö° üí° üîÑ</div>
                            <p>Connect all components in parallel</p>
                        </div>
                        <p><strong>Correct Connections:</strong><br>
                        1. Battery (+) ‚Üí Switch IN<br>
                        2. Switch OUT ‚Üí Bulb (+) AND Motor (+)<br>
                        3. Bulb (-) ‚Üí Battery (-)<br>
                        4. Motor (-) ‚Üí Battery (-)</p>
                        <p>Both loads (bulb and motor) share the same battery and switch.</p>
                    `;
                } else {
                    hintHTML = `
                        <p><strong>Your circuit is almost complete!</strong></p>
                        <div class="hint-diagram">
                            <div style="font-size: 3rem;">‚úÖ</div>
                            <p style="margin-top: 10px;">Click "Test Circuit" to check if it works</p>
                        </div>
                        <p>Make sure:<br>
                        ‚Ä¢ All components are properly connected<br>
                        ‚Ä¢ Red (+) terminals connect to Red (+)<br>
                        ‚Ä¢ Blue (-) terminals connect to Blue (-)<br>
                        ‚Ä¢ There's a complete loop back to the battery</p>
                        <p>Electricity flows from battery (+) through components back to battery (-).</p>
                    `;
                }
            }
            
            hintContent.innerHTML = hintHTML;
            hintPopup.classList.add('active');
            popupOverlay.classList.add('active');
        }

        // Next Level
        function nextLevel() {
            document.getElementById('level-complete').style.display = 'none';
            levelCompleted = false;
            
            if (currentLevel + 1 < gameLevels.length && gameLevels[currentLevel + 1].unlocked) {
                currentLevel++;
                loadLevel(currentLevel);
                showToast(`Starting Level ${currentLevel}`, 'success');
            } else {
                showToast('üéâ All available levels completed!', 'success');
            }
        }

        // Play Again
        function playAgain() {
            document.getElementById('level-complete').style.display = 'none';
            levelCompleted = false;
            loadLevel(currentLevel);
            showToast(`Playing Level ${currentLevel} again`, 'info');
        }

        // Load Level - FIXED FLOW
        function loadLevel(levelIndex) {
            currentLevel = levelIndex;
            const level = gameLevels[levelIndex];
            
            // Hide everything first
            gameHeader.style.display = 'none';
            gameStatsContainer.style.display = 'none';
            gameArea.style.display = 'none';
            demoOverlay.style.display = 'none';
            postDemoMessage.classList.remove('active');
            instructionsModal.style.display = 'none';
            levelComplete.style.display = 'none';
            
            if (level.id === 0) {
                challengeTitle.textContent = `Demo: ${level.title[currentLanguage]}`;
                isDemoMode = true;
                demoStep = 1;
                updateDemoStep();
                demoOverlay.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            } else {
                challengeTitle.textContent = `Level ${level.id}: ${level.title[currentLanguage]}`;
                gameHeader.style.display = 'block';
                gameStatsContainer.style.display = 'block';
                gameArea.style.display = 'block';
                isDemoMode = false;
                document.body.style.overflow = 'auto';
            }
            
            challengeDescription.textContent = level.description[currentLanguage];
            
            clearCircuit();
            levelStartTime = Date.now();
            
            timeLeft = level.timeLimit;
            updateTimerDisplay();
            
            if (level.timeLimit > 0) {
                startTimer();
            }
            
            updateRequirements();
        }

        // Timer Functions
        function startTimer() {
            clearInterval(timerInterval);
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    showTimeUp();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            timeElement.textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function showTimeUp() {
            showToast("Time's up! Try again.", 'error');
            clearCircuit();
        }

        // Update Score and Streak
        function updateScore() {
            scoreElement.textContent = `Score: ${score}`;
        }

        function updateStreak() {
            streakElement.textContent = `Streak: ${streak}`;
        }

        // Show Toast
        function showToast(message, type) {
            document.querySelectorAll('.toast').forEach(toast => toast.remove());
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'times-circle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 10);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Show Instructions (from scoreboard)
        function showInstructions() {
            scoreboard.classList.remove('active');
            instructionsModal.style.display = 'flex';
        }

        // Switch Language
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            
            const translations = {
                en: {
                    'nav-dashboard': 'Dashboard','nav-about':'About','nav-contact':'Contact',
                    'game-title':'Interactive Circuit Builder','game-desc':'Build real circuits! Drag components, connect terminals with wires, and watch electricity flow.',
                    'correct-title':'Circuit Working!','incorrect-title':'Circuit Error!',
                    'continue-btn':'Continue','level-title':'Circuit Complete!','level-text':'Perfect! Your circuit is working.',
                    'next-level':'Next Level','instructions-title':'How to Build Circuits','instructions-intro':'Welcome to Circuit Builder!',
                    'instruction-1':'üì¶ Drag components from the library to the circuit board',
                    'instruction-2':'‚ö° Click on a terminal (colored dots) to start a connection',
                    'instruction-3':'üîó Click another terminal to complete the wire connection',
                    'instruction-4':'üîã Build complete circuits: Battery(+) ‚Üí Load(+) ‚Üí Load(-) ‚Üí Battery(-)',
                    'instruction-5':'üöÄ Click "Test Circuit" to see current flow',
                    'instruction-6':'üí° Connect switches between battery and load to control circuit',
                    'instructions-outro':'Build working circuits to complete each challenge!','start-game-btn':'Start Demo Level',
                    'circuit-board':'Circuit Board','components-library':'Components Library'
                },
                or: {
                    'nav-dashboard':'‡¨°‡≠ç‡≠ü‡¨æ‡¨∏‡¨¨‡≠ã‡¨∞‡≠ç‡¨°','nav-about':'‡¨¨‡¨ø‡¨∑‡≠ü‡¨∞‡≠á','nav-contact':'‡¨Ø‡≠ã‡¨ó‡¨æ‡¨Ø‡≠ã‡¨ó',
                    'game-title':'‡¨á‡¨£‡≠ç‡¨ü‡¨∞‡¨æ‡¨ï‡≠ç‡¨ü‡¨ø‡¨≠‡≠ç ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡¨ø‡¨≤‡¨°‡¨∞‡≠ç','game-desc':'‡¨™‡≠ç‡¨∞‡¨ï‡≠É‡¨§ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å! ‡¨ò‡¨ü‡¨ï‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å, ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨§‡¨æ‡¨∞‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å ‡¨è‡¨¨‡¨Ç ‡¨¨‡¨ø‡¨¶‡≠ç‡≠ü‡≠Å‡¨§‡≠ç ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π ‡¨¶‡≠á‡¨ñ‡¨®‡≠ç‡¨§‡≠Å‡•§',
                    'correct-title':'‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡≠Å‡¨õ‡¨ø!','incorrect-title':'‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡≠ç‡¨∞‡≠Å‡¨ü‡¨ø!',
                    'continue-btn':'‡¨ú‡¨æ‡¨∞‡¨ø ‡¨∞‡¨ñ‡¨®‡≠ç‡¨§‡≠Å','level-title':'‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£!','level-text':'‡¨™‡¨∞‡¨´‡≠á‡¨ï‡≠ç‡¨ü! ‡¨Ü‡¨™‡¨£‡¨ô‡≠ç‡¨ï‡¨∞ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨ï‡¨æ‡¨Æ ‡¨ï‡¨∞‡≠Å‡¨õ‡¨ø‡•§',
                    'next-level':'‡¨™‡¨∞‡¨¨‡¨∞‡≠ç‡¨§‡≠ç‡¨§‡≠Ä ‡¨∏‡≠ç‡¨§‡¨∞','instructions-title':'‡¨ï‡¨ø‡¨™‡¨∞‡¨ø ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨ø‡¨¨‡≠á','instructions-intro':'‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡¨ø‡¨≤‡¨°‡¨∞‡¨ï‡≠Å ‡¨∏‡≠ç‡≠±‡¨æ‡¨ó‡¨§!',
                    'instruction-1':'üì¶ ‡¨≤‡¨æ‡¨á‡¨¨‡≠ç‡¨∞‡≠á‡¨∞‡≠Ä‡¨∞‡≠Å ‡¨ò‡¨ü‡¨ï‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡≠ã‡¨∞‡≠ç‡¨°‡¨ï‡≠Å ‡¨ü‡¨æ‡¨£‡¨®‡≠ç‡¨§‡≠Å',
                    'instruction-2':'‚ö° ‡¨è‡¨ï ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç (‡¨∞‡¨ô‡≠ç‡¨ó‡≠Ä‡¨® ‡¨¨‡¨ø‡¨®‡≠ç‡¨¶‡≠Å) ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨è‡¨ï ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                    'instruction-3':'üîó ‡¨Ö‡¨®‡≠ç‡≠ü ‡¨è‡¨ï ‡¨ü‡¨∞‡≠ç‡¨Æ‡¨ø‡¨®‡¨æ‡¨≤‡≠ç ‡¨â‡¨™‡¨∞‡≠á ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨ø ‡¨§‡¨æ‡¨∞ ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                    'instruction-4':'üîã ‡¨∏‡¨Æ‡≠ç‡¨™‡≠Ç‡¨∞‡≠ç‡¨£‡≠ç‡¨£ ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å: ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä(+) ‚Üí ‡¨≤‡≠ã‡¨°‡≠ç(+) ‚Üí ‡¨≤‡≠ã‡¨°‡≠ç(-) ‚Üí ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä(-)',
                    'instruction-5':'üöÄ ‡¨ï‡¨∞‡≠á‡¨£‡≠ç‡¨ü ‡¨™‡≠ç‡¨∞‡¨¨‡¨æ‡¨π ‡¨¶‡≠á‡¨ñ‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å "‡¨ü‡≠á‡¨∑‡≠ç‡¨ü ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç" ‡¨ï‡≠ç‡¨≤‡¨ø‡¨ï‡≠ç ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                    'instruction-6':'üí° ‡¨∏‡≠Å‡¨á‡¨ö‡≠ç‚Äå‡¨ó‡≠Å‡¨°‡¨ø‡¨ï‡≠Å ‡¨¨‡≠ç‡≠ü‡¨æ‡¨ü‡≠á‡¨∞‡≠Ä ‡¨è‡¨¨‡¨Ç ‡¨≤‡≠ã‡¨°‡≠ç ‡¨Æ‡¨ß‡≠ç‡≠ü‡¨∞‡≠á ‡¨∏‡¨Ç‡¨Ø‡≠ã‡¨ó ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                    'instructions-outro':'‡¨™‡≠ç‡¨∞‡¨§‡≠ç‡≠ü‡≠á‡¨ï ‡¨ö‡≠ç‡≠ü‡¨æ‡¨≤‡≠á‡¨û‡≠ç‡¨ú‡≠ç ‡¨∏‡¨Æ‡¨æ‡¨™‡≠ç‡¨§ ‡¨ï‡¨∞‡¨ø‡¨¨‡¨æ ‡¨™‡¨æ‡¨á‡¨Å ‡¨ï‡¨æ‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨ï‡¨æ‡¨∞‡≠Ä ‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨§‡¨ø‡¨Ü‡¨∞‡¨ø ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å!','start-game-btn':'‡¨°‡≠á‡¨Æ‡≠ã ‡¨≤‡≠á‡¨¨‡¨≤‡≠ç ‡¨Ü‡¨∞‡¨Æ‡≠ç‡¨≠ ‡¨ï‡¨∞‡¨®‡≠ç‡¨§‡≠Å',
                    'circuit-board':'‡¨∏‡¨∞‡≠ç‡¨ï‡¨ø‡¨ü‡≠ç ‡¨¨‡≠ã‡¨∞‡≠ç‡¨°','components-library':'‡¨ò‡¨ü‡¨ï ‡¨≤‡¨æ‡¨á‡¨¨‡≠ç‡¨∞‡≠á‡¨∞‡≠Ä'
                },
                hi: {
                    'nav-dashboard':'‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°','nav-about':'‡§π‡§Æ‡§æ‡§∞‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç','nav-contact':'‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç',
                    'game-title':'‡§á‡§Ç‡§ü‡§∞‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§ø‡§≤‡•ç‡§°‡§∞','game-desc':'‡§Ö‡§∏‡§≤‡•Ä ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç! ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç, ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤‡•ã‡§Ç ‡§ï‡•ã ‡§§‡§æ‡§∞‡•ã‡§Ç ‡§∏‡•á ‡§ú‡•ã‡§°‡§º‡•á‡§Ç ‡§î‡§∞ ‡§¨‡§ø‡§ú‡§≤‡•Ä ‡§ï‡§æ ‡§™‡•ç‡§∞‡§µ‡§æ‡§π ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§',
                    'correct-title':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à!','incorrect-title':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!',
                    'continue-btn':'‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç','level-title':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§™‡•Ç‡§∞‡•ç‡§£!','level-text':'‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§∏‡§π‡•Ä! ‡§Ü‡§™‡§ï‡§æ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à‡•§',
                    'next-level':'‡§Ö‡§ó‡§≤‡§æ ‡§∏‡•ç‡§§‡§∞','instructions-title':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§ï‡•à‡§∏‡•á ‡§¨‡§®‡§æ‡§è‡§Ç','instructions-intro':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§ø‡§≤‡•ç‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!',
                    'instruction-1':'üì¶ ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä ‡§∏‡•á ‡§ò‡§ü‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç',
                    'instruction-2':'‚ö° ‡§è‡§ï ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ (‡§∞‡§Ç‡§ó‡•Ä‡§® ‡§¨‡§ø‡§Ç‡§¶‡•Å) ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡§ï‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',
                    'instruction-3':'üîó ‡§§‡§æ‡§∞ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•Ç‡§∏‡§∞‡•á ‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç',
                    'instruction-4':'üîã ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç: ‡§¨‡•à‡§ü‡§∞‡•Ä(+) ‚Üí ‡§≤‡•ã‡§°(+) ‚Üí ‡§≤‡•ã‡§°(-) ‚Üí ‡§¨‡•à‡§ü‡§∞‡•Ä(-)',
                    'instruction-5':'üöÄ ‡§ï‡§∞‡§Ç‡§ü ‡§™‡•ç‡§∞‡§µ‡§æ‡§π ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è "‡§ü‡•á‡§∏‡•ç‡§ü ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü" ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç',
                    'instruction-6':'üí° ‡§¨‡•à‡§ü‡§∞‡•Ä ‡§î‡§∞ ‡§≤‡•ã‡§° ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§∏‡•ç‡§µ‡§ø‡§ö ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç',
                    'instructions-outro':'‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§ö‡•à‡§≤‡•á‡§Ç‡§ú ‡§ï‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§∂‡•Ä‡§≤ ‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç!','start-game-btn':'‡§°‡•á‡§Æ‡•ã ‡§∏‡•ç‡§§‡§∞ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç',
                    'circuit-board':'‡§∏‡§∞‡•ç‡§ï‡§ø‡§ü ‡§¨‡•ã‡§∞‡•ç‡§°','components-library':'‡§ò‡§ü‡§ï ‡§≤‡§æ‡§á‡§¨‡•ç‡§∞‡•á‡§∞‡•Ä'
                }
            };
            
            const map = translations[lang] || translations.en;
            Object.keys(map).forEach(key => {
                const elements = document.querySelectorAll(`[data-translate="${key}"]`);
                elements.forEach(el => {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = map[key];
                    } else {
                        el.textContent = map[key];
                    }
                });
            });
            
            // Update instructions modal
            if (document.getElementById('instructions-title')) {
                document.getElementById('instructions-title').textContent = map['instructions-title'];
                document.getElementById('instructions-intro').textContent = map['instructions-intro'];
                for (let i = 1; i <= 6; i++) {
                    if (document.getElementById(`instruction-${i}`)) {
                        document.getElementById(`instruction-${i}`).textContent = map[`instruction-${i}`];
                    }
                }
                document.getElementById('instructions-outro').textContent = map['instructions-outro'];
                document.getElementById('start-game-btn').textContent = map['start-game-btn'];
            }
            
            // Update demo content
            const demoMap = demoTranslations[lang] || demoTranslations.en;
            for (let i = 1; i <= 6; i++) {
                const titleEl = document.getElementById(`demo-step-${i}-title`);
                const textEl = document.getElementById(`demo-step-${i}-text`);
                const descEl = document.getElementById(`demo-step-${i}-desc`);
                
                if (titleEl) titleEl.innerHTML = demoMap[`demo-step-${i}-title`];
                if (textEl) textEl.innerHTML = demoMap[`demo-step-${i}-text`];
                if (descEl) descEl.innerHTML = demoMap[`demo-step-${i}-desc`];
            }
            
            // Update demo buttons
            document.getElementById('skip-demo').textContent = demoMap['skip-demo'];
            document.getElementById('complete-demo').textContent = demoMap['complete-demo'];
            for (let i = 1; i <= 5; i++) {
                const backBtn = document.getElementById(`back-demo-${i}`);
                const nextBtn = document.getElementById(`next-demo-${i}`);
                if (backBtn) backBtn.textContent = demoMap['back'];
                if (nextBtn) {
                    if (i === 1) nextBtn.textContent = demoMap['lets-start'];
                    else if (i === 2) nextBtn.textContent = demoMap['got-it'];
                    else nextBtn.textContent = demoMap['next'];
                }
            }
            
            // Update post-demo content
            document.getElementById('post-demo-title').textContent = demoMap['post-demo-title'];
            document.getElementById('post-demo-text').textContent = demoMap['post-demo-text'];
            document.getElementById('post-demo-next-title').textContent = demoMap['post-demo-next-title'];
            
            const listItems = document.getElementById('post-demo-list').querySelectorAll('li');
            listItems[0].innerHTML = `<strong>Level 1:</strong> ${demoMap['post-demo-list-item-1']}`;
            listItems[1].innerHTML = `<strong>Level 2:</strong> ${demoMap['post-demo-list-item-2']}`;
            listItems[2].innerHTML = `<strong>Level 3:</strong> ${demoMap['post-demo-list-item-3']}`;
            listItems[3].innerHTML = `<strong>Level 4:</strong> ${demoMap['post-demo-list-item-4']}`;
            
            document.getElementById('start-real-game-btn').innerHTML = `<i class="fas fa-play-circle"></i> ${demoMap['start-real-game']}`;
            document.getElementById('repeat-demo-btn').innerHTML = `<i class="fas fa-redo"></i> ${demoMap['repeat-demo']}`;
            
            // Update scoreboard
            document.getElementById('scoreboard-title').textContent = demoMap['scoreboard-title'];
            document.getElementById('scoreboard-message').textContent = demoMap['scoreboard-message'];
            document.getElementById('scoreboard-total-label').textContent = demoMap['scoreboard-total-label'];
            document.getElementById('scoreboard-levels-label').textContent = demoMap['scoreboard-levels-label'];
            document.getElementById('scoreboard-time-label').textContent = demoMap['scoreboard-time-label'];
            document.getElementById('scoreboard-perfect-label').textContent = demoMap['scoreboard-perfect-label'];
            document.getElementById('scoreboard-restart').innerHTML = `<i class="fas fa-redo"></i> ${demoMap['play-again']}`;
            document.getElementById('scoreboard-menu').innerHTML = `<i class="fas fa-home"></i> ${demoMap['main-menu']}`;
            
            // Update game UI
            document.getElementById('hint-title').textContent = demoMap['hint-title'];
            document.getElementById('connection-text').textContent = demoMap['connection-text'];
            document.getElementById('test-btn-text').textContent = demoMap['test-btn-text'];
            document.getElementById('clear-btn-text').textContent = demoMap['clear-btn-text'];
            document.getElementById('hint-btn-text').textContent = demoMap['hint-btn-text'];
            document.getElementById('close-hint').textContent = demoMap['got-it-btn'];
            
            // Update components on board
            document.querySelectorAll('.component-label').forEach(el => {
                const componentId = parseInt(el.closest('.circuit-component').dataset.componentId);
                const component = placedComponents.find(c => c.id === componentId);
                if (component) {
                    el.textContent = component.data.name[lang] || component.data.name.en;
                }
            });
            
            // Update library items
            document.querySelectorAll('.library-name').forEach((el, index) => {
                if (circuitComponents[index]) {
                    el.textContent = circuitComponents[index].name[lang] || circuitComponents[index].name.en;
                }
            });
            
            // Update level info
            if (currentLevel >= 0 && gameLevels[currentLevel]) {
                const level = gameLevels[currentLevel];
                if (level.id === 0) {
                    challengeTitle.textContent = `Demo: ${level.title[lang] || level.title.en}`;
                } else {
                    challengeTitle.textContent = `Level ${level.id}: ${level.title[lang] || level.title.en}`;
                }
                challengeDescription.textContent = level.description[lang] || level.description.en;
            }
        }

        // Create Confetti
        function createConfetti() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const c = document.createElement('div');
                    c.style.position = 'fixed';
                    c.style.left = Math.random() * 100 + 'vw';
                    c.style.top = '-10px';
                    c.style.width = '10px';
                    c.style.height = '10px';
                    const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#4facfe'];
                    c.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    c.style.zIndex = '1500';
                    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
                    c.style.animation = `confetti-fall ${2 + Math.random() * 3}s ease-out forwards`;
                    
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 4000);
                }, i * 100);
            }
        }

        // Delete Selected Component
        function deleteSelectedComponent() {
            if (selectedTerminal) {
                cancelConnection();
            }
            
            if (placedComponents.length > 0) {
                const lastComponent = placedComponents[placedComponents.length - 1];
                deleteComponent(lastComponent.id);
            }
        }

        // Delete Component
        function deleteComponent(componentId) {
            const component = placedComponents.find(c => c.id === componentId);
            if (!component) return;
            
            component.connections.forEach(conn => {
                const wire = wires.find(w => w.id === conn.wireId);
                if (wire) {
                    wire.element.remove();
                    wires = wires.filter(w => w.id !== wire.id);
                    
                    const otherComp = placedComponents.find(c => c.id === 
                        (wire.from.componentId === componentId ? wire.to.componentId : wire.from.componentId));
                    if (otherComp) {
                        otherComp.connections = otherComp.connections.filter(c => c.wireId !== wire.id);
                    }
                }
            });
            
            const element = document.querySelector(`[data-component-id="${componentId}"]`);
            if (element) {
                element.style.transform = 'scale(0) rotate(180deg)';
                element.style.opacity = '0';
                setTimeout(() => element.remove(), 300);
            }
            
            placedComponents = placedComponents.filter(c => c.id !== componentId);
            
            showToast(`Removed ${component.data.name[currentLanguage]}`, 'info');
            updateRequirements();
            updateCircuitStatus();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
                @keyframes spark {
                    0% { transform: scale(0); opacity: 1; }
                    50% { transform: scale(2); opacity: 0.5; }
                    100% { transform: scale(0); opacity: 0; }
                }
                @keyframes confetti-fall {
                    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
                    100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
                }
                @keyframes pulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.1); }
                }
            `;
            document.head.appendChild(style);
        });

    </script>
</body>
</html>